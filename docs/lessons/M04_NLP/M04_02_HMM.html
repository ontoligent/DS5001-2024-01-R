<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exploratory Text Analytics - 19&nbsp; Predict POS with an HMM</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../lessons/M05_VectorSpaceModels/M05_01_BOW_TFIDF.html" rel="next">
<link href="../../lessons/M04_NLP/M04_01_Pipeline.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-title">Predict POS with an HMM</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Exploratory Text Analytics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ontoligent/DS5001-2024-01-R" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">M01 Introduction</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M01_Intro/M01_01_getting-started.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Setting Up Your Jupyter Environmnet</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M01_Intro/M01_02_hello.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Lab: Hello, World!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M01_Intro/M01_03_first-foray.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Lab: First Foray</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M01_Intro/M01_04_FurtherExploration.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Lab: Further Exploration</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">M02 TextModels</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M02_TextModels/M02_01_Importing-Persuasion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Text into Data: Importing a Text, or, Clip, Chunk, and Split</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M02_TextModels/M02_02_TokenizingWithSciKitLearn.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Tokenizing with SciKit Learn</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M02_TextModels/M02_03_Challenge.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Challenge: Convert Another Text</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">M03 LanguageModels</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_01_Babel.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Baby Babel</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_01a_EntropyExamples.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Entropy Examples</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_02_LanguageModels_V1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Inferring Language Models v1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_02_LanguageModels_V2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Inferring Language Models (v2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_02_LanguageModels_V3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Inferring Language Models (v3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_02_SimpleLangModel.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Demonstration of Simple Language Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_03_Entropy-and-Perplexity.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Entropy and Peplexity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_04-Entropy-and-Term-Length.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Entropy and Term Length</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_EZ.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">How to Create an N-Gram Model from ScratchHow to Create an N-Gram Model from Scratch</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">M04 NLP</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M04_NLP/M04_00_NLTK_Intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">NLTK Parsers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M04_NLP/M04_01_Pipeline.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">NLP and the Pipeline</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M04_NLP/M04_02_HMM.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Predict POS with an HMM</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">M05 VectorSpaceModels</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M05_VectorSpaceModels/M05_01_BOW_TFIDF.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Vector Spaces, BOW, and TFIDF</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M05_VectorSpaceModels/M05_02_TimeTokenMatrices.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Time-Token Matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M05_VectorSpaceModels/M05_03_TFIDF_Exploration.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Variant TFIDFs and Document Significance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">M06 CusteringSimilarity</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M06_CusteringSimilarity/M06_01_SimilarityMeasures.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Similarity and Distance Measures</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">M07 FeaturesAndComponents</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M07_FeaturesAndComponents/M07_01_PCA.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">PCA from Scratch</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">M08 TopicModels</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08_TopicModels/M08_01_GibbsSampler.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Gibbs Sampler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08_TopicModels/M08_02_LDASciKitLearn.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">LDA with SciKit Learn</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08_TopicModels/M08_03_TopicSimilarity.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Topic Similarity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08_TopicModels/M08_04_TopicContiguity.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Topic Contiguity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08_TopicModels/M08_05_PyLDAVis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">PyLDAVis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08_TopicModels/Untitled.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Untitled.html</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">M08a Visualization</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08a_Visualization/M08a_01_Gensim.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Other Tools</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08a_Visualization/M08a_02_GensimRunCompareLDA.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08a_Visualization/M08a_03_MALLET.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08a_Visualization/M08a_04_Mazo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">M09 WordEmbedding</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M09_WordEmbedding/M09_01_GloVe.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M09_WordEmbedding/M09_02_PMI_SVD.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M09_WordEmbedding/M09_03_SkipgramRepresentation.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M09_WordEmbedding/M09_04_word2vec.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M09_WordEmbedding/M09_05_FastText.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M09_WordEmbedding/Untitled.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Untitled.html</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M09_WordEmbedding/run_fasttext.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">FastText Model</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false">M10 SentimentAnalysis</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M10_SentimentAnalysis/M10_01_GeneralInquirer.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M10_SentimentAnalysis/M10_02_CombineLexicons.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M10_SentimentAnalysis/M10_03_Novel.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M10_SentimentAnalysis/M10_04_AustenMelville.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M10_SentimentAnalysis/M10_05_WordShiftGraphs.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M10_SentimentAnalysis/M10_06_Doc2Vec.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false">M11 Narrative</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M11_Narrative/M11_01_ExportBooksWithSentiment.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M11_Narrative/M11_02_SyuzhetPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M11_Narrative/M11_03_Syuzhet_R.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M11_Narrative/M11_04_Syuzhet_RGeneral.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="false">M12 Classification</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M12_Classification/M12_01_NaiveBayesWineReviews.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M12_Classification/M12_01b_SKLearnMNB.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M12_Classification/M12_02_PerceptronWine.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M12_Classification/M12_03.ExpectedMutualInformation.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M12_Classification/M12_04_Viz.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M12_Classification/Untitled.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="false">M13 LLMs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M13_LLMs/M13_01_ChatGPTDemo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M13_LLMs/M13_02_ChatGPTDemo2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M13_LLMs/M13_03_ChatGPT4Demo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M13_LLMs/M13_play.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">M13_play.html</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M13_LLMs/tokenizer_training.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Loading the dataset</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" aria-expanded="false">M90 DispersionPlots</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M90_DispersionPlots/m01.04-austen-kde.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Synopsis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M90_DispersionPlots/onehot.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">onehot.html</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" aria-expanded="false">M91 Charrette</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M91_Charrette/CharretteFIguresAndCharacters.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Figures and Characters</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M91_Charrette/CharretteTokens.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Config</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" aria-expanded="false">M92 Helpers</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M92_Helpers/M00_01_VectorizationWithSKLearn.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M92_Helpers/M00_02_SpaCy.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#set-up" id="toc-set-up" class="nav-link active" data-scroll-target="#set-up">Set Up</a></li>
  <li><a href="#get-annotated-token-table" id="toc-get-annotated-token-table" class="nav-link" data-scroll-target="#get-annotated-token-table">Get Annotated <code>TOKEN</code> Table</a></li>
  <li><a href="#create-table-of-pos-tags" id="toc-create-table-of-pos-tags" class="nav-link" data-scroll-target="#create-table-of-pos-tags">Create Table of POS Tags</a>
  <ul class="collapse">
  <li><a href="#grab-upenn-codes" id="toc-grab-upenn-codes" class="nav-link" data-scroll-target="#grab-upenn-codes">Grab UPenn Codes</a></li>
  <li><a href="#add-value-counts" id="toc-add-value-counts" class="nav-link" data-scroll-target="#add-value-counts">Add value counts</a></li>
  <li><a href="#create-pos_group-table" id="toc-create-pos_group-table" class="nav-link" data-scroll-target="#create-pos_group-table">Create <code>POS_GROUP</code> table</a></li>
  <li><a href="#save" id="toc-save" class="nav-link" data-scroll-target="#save">Save</a></li>
  </ul></li>
  <li><a href="#extract-model-from-token" id="toc-extract-model-from-token" class="nav-link" data-scroll-target="#extract-model-from-token">Extract Model from <code>TOKEN</code></a>
  <ul class="collapse">
  <li><a href="#create-table-of-t_n-rightarrow-t_n1-transissions-a" id="toc-create-table-of-t_n-rightarrow-t_n1-transissions-a" class="nav-link" data-scroll-target="#create-table-of-t_n-rightarrow-t_n1-transissions-a">Create Table of <span class="math inline">\(t_n \rightarrow t_{n+1}\)</span> Transissions (<span class="math inline">\(A\)</span>)</a></li>
  <li><a href="#create-table-of-initial-state-probabilities-pi" id="toc-create-table-of-initial-state-probabilities-pi" class="nav-link" data-scroll-target="#create-table-of-initial-state-probabilities-pi">Create Table of Initial State Probabilities <span class="math inline">\(\Pi\)</span></a></li>
  <li><a href="#make-sure-shares-sample-space-with-a-and-b" id="toc-make-sure-shares-sample-space-with-a-and-b" class="nav-link" data-scroll-target="#make-sure-shares-sample-space-with-a-and-b">Make sure $$ shares sample space with <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span></a></li>
  <li><a href="#create-table-of-t_n-rightarrow-o_n-emissions-b" id="toc-create-table-of-t_n-rightarrow-o_n-emissions-b" class="nav-link" data-scroll-target="#create-table-of-t_n-rightarrow-o_n-emissions-b">Create Table of <span class="math inline">\(t_n \rightarrow o_n\)</span> Emissions ($ B $)</a></li>
  <li><a href="#put-into-single-model-hmm" id="toc-put-into-single-model-hmm" class="nav-link" data-scroll-target="#put-into-single-model-hmm">Put into single model <code>HMM</code></a></li>
  </ul></li>
  <li><a href="#prepare-test-data" id="toc-prepare-test-data" class="nav-link" data-scroll-target="#prepare-test-data">Prepare Test Data</a></li>
  <li><a href="#the-viterbi-algorithm" id="toc-the-viterbi-algorithm" class="nav-link" data-scroll-target="#the-viterbi-algorithm">The Viterbi Algorithm</a>
  <ul class="collapse">
  <li><a href="#define-function" id="toc-define-function" class="nav-link" data-scroll-target="#define-function">Define function</a></li>
  <li><a href="#test-with-one-sentence" id="toc-test-with-one-sentence" class="nav-link" data-scroll-target="#test-with-one-sentence">Test with one sentence</a></li>
  <li><a href="#diminishing-probabilities" id="toc-diminishing-probabilities" class="nav-link" data-scroll-target="#diminishing-probabilities">Diminishing probabilities</a></li>
  </ul></li>
  <li><a href="#eta-version" id="toc-eta-version" class="nav-link" data-scroll-target="#eta-version">ETA Version</a>
  <ul class="collapse">
  <li><a href="#define-the-function" id="toc-define-the-function" class="nav-link" data-scroll-target="#define-the-function">Define the function</a></li>
  <li><a href="#try-wiith-one-sentence" id="toc-try-wiith-one-sentence" class="nav-link" data-scroll-target="#try-wiith-one-sentence">Try wiith one sentence</a></li>
  <li><a href="#try-with-all-sentences" id="toc-try-with-all-sentences" class="nav-link" data-scroll-target="#try-with-all-sentences">Try with all sentences</a></li>
  <li><a href="#what-pos-tags-are-hardest-to-predict" id="toc-what-pos-tags-are-hardest-to-predict" class="nav-link" data-scroll-target="#what-pos-tags-are-hardest-to-predict">What POS tags are hardest to predict?</a></li>
  <li><a href="#add-features-to-sentences" id="toc-add-features-to-sentences" class="nav-link" data-scroll-target="#add-features-to-sentences">Add features to sentences</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.dev/ontoligent/DS5001-2024-01-R/blob/main/lessons/M04_NLP/M04_02_HMM.ipynb" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-title">Predict POS with an HMM</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="sourceCode" id="cb1"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Course</span><span class="kw">:</span><span class="at">   DS 5001</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Module</span><span class="kw">:</span><span class="at">   04 Lab</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Topic</span><span class="kw">:</span><span class="at">    Predict POS with an HMM</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Author</span><span class="kw">:</span><span class="at">   R.C. Alvarado</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Date</span><span class="kw">:</span><span class="at">     14 February 2022 (revised and improved)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Purpose</strong>: Demonstrate Hidden Markov Model applied to POS detection, including the Viterbi algorithm by hand.</p>
<section id="set-up" class="level1">
<h1>Set Up</h1>
<div class="cell" data-tags="[]" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> configparser</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> configparser.ConfigParser()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>config.read(<span class="st">"../env.ini"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>data_home <span class="op">=</span> config[<span class="st">'DEFAULT'</span>][<span class="st">'data_home'</span>]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>output_dir <span class="op">=</span> config[<span class="st">'DEFAULT'</span>][<span class="st">'output_dir'</span>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>local_lib <span class="op">=</span> config[<span class="st">'DEFAULT'</span>][<span class="st">'local_lib'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data_prefix <span class="op">=</span> <span class="st">'austen-melville'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>OHCO <span class="op">=</span> [<span class="st">'book_id'</span>, <span class="st">'chap_id'</span>, <span class="st">'para_num'</span>, <span class="st">'sent_num'</span>, <span class="st">'token_num'</span>]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>SENT <span class="op">=</span> OHCO[:<span class="dv">4</span>]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> <span class="st">"YlGnBu"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy <span class="im">as</span> sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sp.__version__</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>'1.11.3'</code></pre>
</div>
</div>
</section>
<section id="get-annotated-token-table" class="level1">
<h1>Get Annotated <code>TOKEN</code> Table</h1>
<p>We use the <code>CORPUS</code> table from our previous exercise.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>TOKEN <span class="op">=</span> pd.read_csv(<span class="ss">f"</span><span class="sc">{</span>output_dir<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>data_prefix<span class="sc">}</span><span class="ss">-CORPUS.csv"</span>).set_index(OHCO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>TOKEN</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>pos_tuple</th>
      <th>pos</th>
      <th>token_str</th>
      <th>term_str</th>
    </tr>
    <tr>
      <th>book_id</th>
      <th>chap_id</th>
      <th>para_num</th>
      <th>sent_num</th>
      <th>token_num</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">105</th>
      <th rowspan="5" valign="top">1</th>
      <th rowspan="5" valign="top">1</th>
      <th rowspan="5" valign="top">0</th>
      <th>0</th>
      <td>('Sir', 'NNP')</td>
      <td>NNP</td>
      <td>Sir</td>
      <td>sir</td>
    </tr>
    <tr>
      <th>1</th>
      <td>('Walter', 'NNP')</td>
      <td>NNP</td>
      <td>Walter</td>
      <td>walter</td>
    </tr>
    <tr>
      <th>2</th>
      <td>('Elliot,', 'NNP')</td>
      <td>NNP</td>
      <td>Elliot,</td>
      <td>elliot</td>
    </tr>
    <tr>
      <th>3</th>
      <td>('of', 'IN')</td>
      <td>IN</td>
      <td>of</td>
      <td>of</td>
    </tr>
    <tr>
      <th>4</th>
      <td>('Kellynch', 'NNP')</td>
      <td>NNP</td>
      <td>Kellynch</td>
      <td>kellynch</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">34970</th>
      <th rowspan="5" valign="top">114</th>
      <th rowspan="5" valign="top">24</th>
      <th rowspan="5" valign="top">0</th>
      <th>6</th>
      <td>('The', 'DT')</td>
      <td>DT</td>
      <td>The</td>
      <td>the</td>
    </tr>
    <tr>
      <th>7</th>
      <td>('Ambiguities,', 'NNP')</td>
      <td>NNP</td>
      <td>Ambiguities,</td>
      <td>ambiguities</td>
    </tr>
    <tr>
      <th>8</th>
      <td>('by', 'IN')</td>
      <td>IN</td>
      <td>by</td>
      <td>by</td>
    </tr>
    <tr>
      <th>9</th>
      <td>('Herman', 'NNP')</td>
      <td>NNP</td>
      <td>Herman</td>
      <td>herman</td>
    </tr>
    <tr>
      <th>10</th>
      <td>('Melville', 'NNP')</td>
      <td>NNP</td>
      <td>Melville</td>
      <td>melville</td>
    </tr>
  </tbody>
</table>
<p>2059272 rows  4 columns</p>
</div>
</div>
</div>
</section>
<section id="create-table-of-pos-tags" class="level1">
<h1>Create Table of POS Tags</h1>
<p>We create a table rrom the Penn Treebank Project list of part-of-speech tags.</p>
<section id="grab-upenn-codes" class="level2">
<h2 class="anchored" data-anchor-id="grab-upenn-codes">Grab UPenn Codes</h2>
<p>We get a text version of the UPenn Codes, or tag set, by calling <code>nltk.help.upenn_tagset()</code>. The extra information can be used later in visualizations, etc.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>POS <span class="op">=</span> pd.read_csv(<span class="ss">f'</span><span class="sc">{</span>data_home<span class="sc">}</span><span class="ss">/misc/upenn_tagset.txt'</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, names<span class="op">=</span>[<span class="st">'pos_code'</span>,<span class="st">'def'</span>])</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>POS <span class="op">=</span> POS[POS.pos_code.<span class="bu">str</span>.match(<span class="vs">r'^\w'</span>)].set_index(<span class="st">'pos_code'</span>) <span class="co"># Keep only letter codes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>POS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>def</th>
    </tr>
    <tr>
      <th>pos_code</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CC</th>
      <td>conjunction, coordinating</td>
    </tr>
    <tr>
      <th>CD</th>
      <td>numeral, cardinal</td>
    </tr>
    <tr>
      <th>DT</th>
      <td>determiner</td>
    </tr>
    <tr>
      <th>EX</th>
      <td>existential there</td>
    </tr>
    <tr>
      <th>FW</th>
      <td>foreign word</td>
    </tr>
    <tr>
      <th>IN</th>
      <td>preposition or conjunction, subordinating</td>
    </tr>
    <tr>
      <th>JJ</th>
      <td>adjective or numeral, ordinal</td>
    </tr>
    <tr>
      <th>JJR</th>
      <td>adjective, comparative</td>
    </tr>
    <tr>
      <th>JJS</th>
      <td>adjective, superlative</td>
    </tr>
    <tr>
      <th>LS</th>
      <td>list item marker</td>
    </tr>
    <tr>
      <th>MD</th>
      <td>modal auxiliary</td>
    </tr>
    <tr>
      <th>NN</th>
      <td>noun, common, singular or mass</td>
    </tr>
    <tr>
      <th>NNP</th>
      <td>noun, proper, singular</td>
    </tr>
    <tr>
      <th>NNPS</th>
      <td>noun, proper, plural</td>
    </tr>
    <tr>
      <th>NNS</th>
      <td>noun, common, plural</td>
    </tr>
    <tr>
      <th>PDT</th>
      <td>pre-determiner</td>
    </tr>
    <tr>
      <th>POS</th>
      <td>genitive marker</td>
    </tr>
    <tr>
      <th>PRP</th>
      <td>pronoun, personal</td>
    </tr>
    <tr>
      <th>PRP$</th>
      <td>pronoun, possessive</td>
    </tr>
    <tr>
      <th>RB</th>
      <td>adverb</td>
    </tr>
    <tr>
      <th>RBR</th>
      <td>adverb, comparative</td>
    </tr>
    <tr>
      <th>RBS</th>
      <td>adverb, superlative</td>
    </tr>
    <tr>
      <th>RP</th>
      <td>particle</td>
    </tr>
    <tr>
      <th>SYM</th>
      <td>symbol</td>
    </tr>
    <tr>
      <th>TO</th>
      <td>"to" as preposition or infinitive marker</td>
    </tr>
    <tr>
      <th>UH</th>
      <td>interjection</td>
    </tr>
    <tr>
      <th>VB</th>
      <td>verb, base form</td>
    </tr>
    <tr>
      <th>VBD</th>
      <td>verb, past tense</td>
    </tr>
    <tr>
      <th>VBG</th>
      <td>verb, present participle or gerund</td>
    </tr>
    <tr>
      <th>VBN</th>
      <td>verb, past participle</td>
    </tr>
    <tr>
      <th>VBP</th>
      <td>verb, present tense, not 3rd person singular</td>
    </tr>
    <tr>
      <th>VBZ</th>
      <td>verb, present tense, 3rd person singular</td>
    </tr>
    <tr>
      <th>WDT</th>
      <td>WH-determiner</td>
    </tr>
    <tr>
      <th>WP</th>
      <td>WH-pronoun</td>
    </tr>
    <tr>
      <th>WP$</th>
      <td>WH-pronoun, possessive</td>
    </tr>
    <tr>
      <th>WRB</th>
      <td>Wh-adverb</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="add-value-counts" class="level2">
<h2 class="anchored" data-anchor-id="add-value-counts">Add value counts</h2>
<div class="cell" data-scrolled="true" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>POS[<span class="st">'n'</span>] <span class="op">=</span> TOKEN.pos.value_counts().to_frame().sort_index()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>POS[<span class="st">'n'</span>] <span class="op">=</span> POS[<span class="st">'n'</span>].fillna(<span class="dv">0</span>).astype(<span class="st">'int'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>POS.sort_values(<span class="st">'n'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>def</th>
      <th>n</th>
    </tr>
    <tr>
      <th>pos_code</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>NN</th>
      <td>noun, common, singular or mass</td>
      <td>383976</td>
    </tr>
    <tr>
      <th>IN</th>
      <td>preposition or conjunction, subordinating</td>
      <td>264122</td>
    </tr>
    <tr>
      <th>DT</th>
      <td>determiner</td>
      <td>204813</td>
    </tr>
    <tr>
      <th>JJ</th>
      <td>adjective or numeral, ordinal</td>
      <td>155155</td>
    </tr>
    <tr>
      <th>PRP</th>
      <td>pronoun, personal</td>
      <td>117186</td>
    </tr>
    <tr>
      <th>RB</th>
      <td>adverb</td>
      <td>113500</td>
    </tr>
    <tr>
      <th>VBD</th>
      <td>verb, past tense</td>
      <td>104096</td>
    </tr>
    <tr>
      <th>NNP</th>
      <td>noun, proper, singular</td>
      <td>97366</td>
    </tr>
    <tr>
      <th>VB</th>
      <td>verb, base form</td>
      <td>90361</td>
    </tr>
    <tr>
      <th>CC</th>
      <td>conjunction, coordinating</td>
      <td>83450</td>
    </tr>
    <tr>
      <th>PRP$</th>
      <td>pronoun, possessive</td>
      <td>59075</td>
    </tr>
    <tr>
      <th>NNS</th>
      <td>noun, common, plural</td>
      <td>58630</td>
    </tr>
    <tr>
      <th>TO</th>
      <td>"to" as preposition or infinitive marker</td>
      <td>55581</td>
    </tr>
    <tr>
      <th>VBN</th>
      <td>verb, past participle</td>
      <td>51108</td>
    </tr>
    <tr>
      <th>VBG</th>
      <td>verb, present participle or gerund</td>
      <td>41914</td>
    </tr>
    <tr>
      <th>VBP</th>
      <td>verb, present tense, not 3rd person singular</td>
      <td>40009</td>
    </tr>
    <tr>
      <th>MD</th>
      <td>modal auxiliary</td>
      <td>31876</td>
    </tr>
    <tr>
      <th>VBZ</th>
      <td>verb, present tense, 3rd person singular</td>
      <td>29391</td>
    </tr>
    <tr>
      <th>CD</th>
      <td>numeral, cardinal</td>
      <td>12610</td>
    </tr>
    <tr>
      <th>WDT</th>
      <td>WH-determiner</td>
      <td>11000</td>
    </tr>
    <tr>
      <th>WP</th>
      <td>WH-pronoun</td>
      <td>9930</td>
    </tr>
    <tr>
      <th>WRB</th>
      <td>Wh-adverb</td>
      <td>9757</td>
    </tr>
    <tr>
      <th>RP</th>
      <td>particle</td>
      <td>7897</td>
    </tr>
    <tr>
      <th>JJR</th>
      <td>adjective, comparative</td>
      <td>5268</td>
    </tr>
    <tr>
      <th>JJS</th>
      <td>adjective, superlative</td>
      <td>4710</td>
    </tr>
    <tr>
      <th>PDT</th>
      <td>pre-determiner</td>
      <td>4686</td>
    </tr>
    <tr>
      <th>EX</th>
      <td>existential there</td>
      <td>3776</td>
    </tr>
    <tr>
      <th>RBR</th>
      <td>adverb, comparative</td>
      <td>3360</td>
    </tr>
    <tr>
      <th>RBS</th>
      <td>adverb, superlative</td>
      <td>2199</td>
    </tr>
    <tr>
      <th>WP$</th>
      <td>WH-pronoun, possessive</td>
      <td>842</td>
    </tr>
    <tr>
      <th>FW</th>
      <td>foreign word</td>
      <td>490</td>
    </tr>
    <tr>
      <th>NNPS</th>
      <td>noun, proper, plural</td>
      <td>415</td>
    </tr>
    <tr>
      <th>POS</th>
      <td>genitive marker</td>
      <td>332</td>
    </tr>
    <tr>
      <th>UH</th>
      <td>interjection</td>
      <td>74</td>
    </tr>
    <tr>
      <th>LS</th>
      <td>list item marker</td>
      <td>3</td>
    </tr>
    <tr>
      <th>SYM</th>
      <td>symbol</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="create-pos_group-table" class="level2">
<h2 class="anchored" data-anchor-id="create-pos_group-table">Create <code>POS_GROUP</code> table</h2>
<p>We want a simplified list of grammatical categories. We use the first two letters of each code name as our group.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add pos_group feature to POS and TOKEN</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>POS[<span class="st">'pos_group'</span>] <span class="op">=</span> POS.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.name[:<span class="dv">2</span>], <span class="dv">1</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>TOKEN[<span class="st">'pos_group'</span>] <span class="op">=</span> TOKEN.pos.<span class="bu">str</span>[:<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate new table from it</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>POS_GROUP <span class="op">=</span> POS.groupby(<span class="st">'pos_group'</span>).n.<span class="bu">sum</span>().to_frame(<span class="st">'n'</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>POS_GROUP <span class="op">=</span> POS_GROUP[POS_GROUP.n <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>POS_GROUP[<span class="st">'def'</span>] <span class="op">=</span> POS.groupby(<span class="st">'pos_group'</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">'; '</span>.join(x[<span class="st">'def'</span>]))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>POS_GROUP[<span class="st">'p'</span>] <span class="op">=</span> POS_GROUP.n <span class="op">/</span> POS_GROUP.n.<span class="bu">sum</span>()</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>POS_GROUP[<span class="st">'i'</span>] <span class="op">=</span> np.log2(<span class="dv">1</span><span class="op">/</span>POS_GROUP.p)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>POS_GROUP[<span class="st">'h'</span>] <span class="op">=</span> POS_GROUP.p <span class="op">*</span> POS_GROUP.i</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>POS_GROUP.sort_values(<span class="st">'i'</span>).style.background_gradient(cmap<span class="op">=</span>colors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

<style type="text/css">
#T_579ec_row0_col0, #T_579ec_row0_col2, #T_579ec_row0_col4, #T_579ec_row20_col3 {
  background-color: #081d58;
  color: #f1f1f1;
}
#T_579ec_row0_col3, #T_579ec_row17_col0, #T_579ec_row17_col2, #T_579ec_row18_col0, #T_579ec_row18_col2, #T_579ec_row19_col0, #T_579ec_row19_col2, #T_579ec_row19_col4, #T_579ec_row20_col0, #T_579ec_row20_col2, #T_579ec_row20_col4 {
  background-color: #ffffd9;
  color: #000000;
}
#T_579ec_row1_col0, #T_579ec_row1_col2 {
  background-color: #1f82b9;
  color: #f1f1f1;
}
#T_579ec_row1_col3, #T_579ec_row16_col4 {
  background-color: #fafdcf;
  color: #000000;
}
#T_579ec_row1_col4 {
  background-color: #253795;
  color: #f1f1f1;
}
#T_579ec_row2_col0, #T_579ec_row2_col2 {
  background-color: #46b8c3;
  color: #f1f1f1;
}
#T_579ec_row2_col3, #T_579ec_row9_col0, #T_579ec_row9_col2, #T_579ec_row14_col4 {
  background-color: #f7fcc6;
  color: #000000;
}
#T_579ec_row2_col4 {
  background-color: #225da8;
  color: #f1f1f1;
}
#T_579ec_row3_col0, #T_579ec_row3_col2 {
  background-color: #7cccbb;
  color: #000000;
}
#T_579ec_row3_col3, #T_579ec_row11_col4, #T_579ec_row12_col4 {
  background-color: #f4fbc0;
  color: #000000;
}
#T_579ec_row3_col4 {
  background-color: #1e85ba;
  color: #f1f1f1;
}
#T_579ec_row4_col0, #T_579ec_row4_col2 {
  background-color: #9cd8b8;
  color: #000000;
}
#T_579ec_row4_col3 {
  background-color: #f2fabc;
  color: #000000;
}
#T_579ec_row4_col4 {
  background-color: #2498c1;
  color: #f1f1f1;
}
#T_579ec_row5_col0, #T_579ec_row5_col2 {
  background-color: #a7dcb7;
  color: #000000;
}
#T_579ec_row5_col3 {
  background-color: #f1faba;
  color: #000000;
}
#T_579ec_row5_col4 {
  background-color: #2b9fc2;
  color: #f1f1f1;
}
#T_579ec_row6_col0, #T_579ec_row6_col2 {
  background-color: #d0edb3;
  color: #000000;
}
#T_579ec_row6_col3 {
  background-color: #edf8b2;
  color: #000000;
}
#T_579ec_row6_col4 {
  background-color: #50bbc2;
  color: #000000;
}
#T_579ec_row7_col0, #T_579ec_row7_col2, #T_579ec_row7_col3 {
  background-color: #e5f5b2;
  color: #000000;
}
#T_579ec_row7_col4 {
  background-color: #83cebb;
  color: #000000;
}
#T_579ec_row8_col0, #T_579ec_row8_col2 {
  background-color: #f0f9b8;
  color: #000000;
}
#T_579ec_row8_col3 {
  background-color: #daf0b3;
  color: #000000;
}
#T_579ec_row8_col4 {
  background-color: #b7e3b6;
  color: #000000;
}
#T_579ec_row9_col3 {
  background-color: #cdebb4;
  color: #000000;
}
#T_579ec_row9_col4 {
  background-color: #dbf1b2;
  color: #000000;
}
#T_579ec_row10_col0, #T_579ec_row10_col2, #T_579ec_row11_col0, #T_579ec_row11_col2, #T_579ec_row12_col0, #T_579ec_row12_col2 {
  background-color: #fcfed3;
  color: #000000;
}
#T_579ec_row10_col3 {
  background-color: #a5dcb7;
  color: #000000;
}
#T_579ec_row10_col4 {
  background-color: #f3fabd;
  color: #000000;
}
#T_579ec_row11_col3, #T_579ec_row12_col3 {
  background-color: #9ed9b8;
  color: #000000;
}
#T_579ec_row13_col0, #T_579ec_row13_col2 {
  background-color: #fdfed4;
  color: #000000;
}
#T_579ec_row13_col3 {
  background-color: #99d7b8;
  color: #000000;
}
#T_579ec_row13_col4 {
  background-color: #f5fbc2;
  color: #000000;
}
#T_579ec_row14_col0, #T_579ec_row14_col2 {
  background-color: #fdfed5;
  color: #000000;
}
#T_579ec_row14_col3 {
  background-color: #8ed3ba;
  color: #000000;
}
#T_579ec_row15_col0, #T_579ec_row15_col2 {
  background-color: #feffd6;
  color: #000000;
}
#T_579ec_row15_col3 {
  background-color: #76cabc;
  color: #000000;
}
#T_579ec_row15_col4 {
  background-color: #f9fdcc;
  color: #000000;
}
#T_579ec_row16_col0, #T_579ec_row16_col2, #T_579ec_row17_col4, #T_579ec_row18_col4 {
  background-color: #feffd8;
  color: #000000;
}
#T_579ec_row16_col3 {
  background-color: #6dc6be;
  color: #000000;
}
#T_579ec_row17_col3 {
  background-color: #2a9ec1;
  color: #f1f1f1;
}
#T_579ec_row18_col3 {
  background-color: #2195c0;
  color: #f1f1f1;
}
#T_579ec_row19_col3 {
  background-color: #2163aa;
  color: #f1f1f1;
}
</style>
<table id="T_579ec">
  <thead>
    <tr>
      <th class="blank level0">&nbsp;</th>
      <th id="T_579ec_level0_col0" class="col_heading level0 col0">n</th>
      <th id="T_579ec_level0_col1" class="col_heading level0 col1">def</th>
      <th id="T_579ec_level0_col2" class="col_heading level0 col2">p</th>
      <th id="T_579ec_level0_col3" class="col_heading level0 col3">i</th>
      <th id="T_579ec_level0_col4" class="col_heading level0 col4">h</th>
    </tr>
    <tr>
      <th class="index_name level0">pos_group</th>
      <th class="blank col0">&nbsp;</th>
      <th class="blank col1">&nbsp;</th>
      <th class="blank col2">&nbsp;</th>
      <th class="blank col3">&nbsp;</th>
      <th class="blank col4">&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_579ec_level0_row0" class="row_heading level0 row0">NN</th>
      <td id="T_579ec_row0_col0" class="data row0 col0">540387</td>
      <td id="T_579ec_row0_col1" class="data row0 col1"> noun, common, singular or mass;  noun, proper, singular;  noun, proper, plural;  noun, common, plural</td>
      <td id="T_579ec_row0_col2" class="data row0 col2">0.262457</td>
      <td id="T_579ec_row0_col3" class="data row0 col3">1.929850</td>
      <td id="T_579ec_row0_col4" class="data row0 col4">0.506502</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row1" class="row_heading level0 row1">VB</th>
      <td id="T_579ec_row1_col0" class="data row1 col0">356879</td>
      <td id="T_579ec_row1_col1" class="data row1 col1"> verb, base form;  verb, past tense;  verb, present participle or gerund;  verb, past participle;  verb, present tense, not 3rd person singular;  verb, present tense, 3rd person singular</td>
      <td id="T_579ec_row1_col2" class="data row1 col2">0.173330</td>
      <td id="T_579ec_row1_col3" class="data row1 col3">2.528407</td>
      <td id="T_579ec_row1_col4" class="data row1 col4">0.438249</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row2" class="row_heading level0 row2">IN</th>
      <td id="T_579ec_row2_col0" class="data row2 col0">264122</td>
      <td id="T_579ec_row2_col1" class="data row2 col1"> preposition or conjunction, subordinating</td>
      <td id="T_579ec_row2_col2" class="data row2 col2">0.128279</td>
      <td id="T_579ec_row2_col3" class="data row2 col3">2.962638</td>
      <td id="T_579ec_row2_col4" class="data row2 col4">0.380046</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row3" class="row_heading level0 row3">DT</th>
      <td id="T_579ec_row3_col0" class="data row3 col0">204813</td>
      <td id="T_579ec_row3_col1" class="data row3 col1"> determiner</td>
      <td id="T_579ec_row3_col2" class="data row3 col2">0.099474</td>
      <td id="T_579ec_row3_col3" class="data row3 col3">3.329535</td>
      <td id="T_579ec_row3_col4" class="data row3 col4">0.331203</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row4" class="row_heading level0 row4">PR</th>
      <td id="T_579ec_row4_col0" class="data row4 col0">176261</td>
      <td id="T_579ec_row4_col1" class="data row4 col1"> pronoun, personal;  pronoun, possessive</td>
      <td id="T_579ec_row4_col2" class="data row4 col2">0.085607</td>
      <td id="T_579ec_row4_col3" class="data row4 col3">3.546129</td>
      <td id="T_579ec_row4_col4" class="data row4 col4">0.303573</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row5" class="row_heading level0 row5">JJ</th>
      <td id="T_579ec_row5_col0" class="data row5 col0">165133</td>
      <td id="T_579ec_row5_col1" class="data row5 col1"> adjective or numeral, ordinal;  adjective, comparative;  adjective, superlative</td>
      <td id="T_579ec_row5_col2" class="data row5 col2">0.080202</td>
      <td id="T_579ec_row5_col3" class="data row5 col3">3.640214</td>
      <td id="T_579ec_row5_col4" class="data row5 col4">0.291953</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row6" class="row_heading level0 row6">RB</th>
      <td id="T_579ec_row6_col0" class="data row6 col0">119059</td>
      <td id="T_579ec_row6_col1" class="data row6 col1"> adverb;  adverb, comparative;  adverb, superlative</td>
      <td id="T_579ec_row6_col2" class="data row6 col2">0.057825</td>
      <td id="T_579ec_row6_col3" class="data row6 col3">4.112166</td>
      <td id="T_579ec_row6_col4" class="data row6 col4">0.237785</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row7" class="row_heading level0 row7">CC</th>
      <td id="T_579ec_row7_col0" class="data row7 col0">83450</td>
      <td id="T_579ec_row7_col1" class="data row7 col1"> conjunction, coordinating</td>
      <td id="T_579ec_row7_col2" class="data row7 col2">0.040530</td>
      <td id="T_579ec_row7_col3" class="data row7 col3">4.624859</td>
      <td id="T_579ec_row7_col4" class="data row7 col4">0.187446</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row8" class="row_heading level0 row8">TO</th>
      <td id="T_579ec_row8_col0" class="data row8 col0">55581</td>
      <td id="T_579ec_row8_col1" class="data row8 col1"> "to" as preposition or infinitive marker</td>
      <td id="T_579ec_row8_col2" class="data row8 col2">0.026995</td>
      <td id="T_579ec_row8_col3" class="data row8 col3">5.211179</td>
      <td id="T_579ec_row8_col4" class="data row8 col4">0.140674</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row9" class="row_heading level0 row9">MD</th>
      <td id="T_579ec_row9_col0" class="data row9 col0">31876</td>
      <td id="T_579ec_row9_col1" class="data row9 col1"> modal auxiliary</td>
      <td id="T_579ec_row9_col2" class="data row9 col2">0.015482</td>
      <td id="T_579ec_row9_col3" class="data row9 col3">6.013300</td>
      <td id="T_579ec_row9_col4" class="data row9 col4">0.093096</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row10" class="row_heading level0 row10">CD</th>
      <td id="T_579ec_row10_col0" class="data row10 col0">12610</td>
      <td id="T_579ec_row10_col1" class="data row10 col1"> numeral, cardinal</td>
      <td id="T_579ec_row10_col2" class="data row10 col2">0.006124</td>
      <td id="T_579ec_row10_col3" class="data row10 col3">7.351202</td>
      <td id="T_579ec_row10_col4" class="data row10 col4">0.045022</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row11" class="row_heading level0 row11">WD</th>
      <td id="T_579ec_row11_col0" class="data row11 col0">11000</td>
      <td id="T_579ec_row11_col1" class="data row11 col1"> WH-determiner</td>
      <td id="T_579ec_row11_col2" class="data row11 col2">0.005343</td>
      <td id="T_579ec_row11_col3" class="data row11 col3">7.548267</td>
      <td id="T_579ec_row11_col4" class="data row11 col4">0.040327</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row12" class="row_heading level0 row12">WP</th>
      <td id="T_579ec_row12_col0" class="data row12 col0">10772</td>
      <td id="T_579ec_row12_col1" class="data row12 col1"> WH-pronoun;  WH-pronoun, possessive</td>
      <td id="T_579ec_row12_col2" class="data row12 col2">0.005232</td>
      <td id="T_579ec_row12_col3" class="data row12 col3">7.578484</td>
      <td id="T_579ec_row12_col4" class="data row12 col4">0.039649</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row13" class="row_heading level0 row13">WR</th>
      <td id="T_579ec_row13_col0" class="data row13 col0">9757</td>
      <td id="T_579ec_row13_col1" class="data row13 col1"> Wh-adverb</td>
      <td id="T_579ec_row13_col2" class="data row13 col2">0.004739</td>
      <td id="T_579ec_row13_col3" class="data row13 col3">7.721261</td>
      <td id="T_579ec_row13_col4" class="data row13 col4">0.036590</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row14" class="row_heading level0 row14">RP</th>
      <td id="T_579ec_row14_col0" class="data row14 col0">7897</td>
      <td id="T_579ec_row14_col1" class="data row14 col1"> particle</td>
      <td id="T_579ec_row14_col2" class="data row14 col2">0.003835</td>
      <td id="T_579ec_row14_col3" class="data row14 col3">8.026394</td>
      <td id="T_579ec_row14_col4" class="data row14 col4">0.030785</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row15" class="row_heading level0 row15">PD</th>
      <td id="T_579ec_row15_col0" class="data row15 col0">4686</td>
      <td id="T_579ec_row15_col1" class="data row15 col1"> pre-determiner</td>
      <td id="T_579ec_row15_col2" class="data row15 col2">0.002276</td>
      <td id="T_579ec_row15_col3" class="data row15 col3">8.779342</td>
      <td id="T_579ec_row15_col4" class="data row15 col4">0.019981</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row16" class="row_heading level0 row16">EX</th>
      <td id="T_579ec_row16_col0" class="data row16 col0">3776</td>
      <td id="T_579ec_row16_col1" class="data row16 col1"> existential there</td>
      <td id="T_579ec_row16_col2" class="data row16 col2">0.001834</td>
      <td id="T_579ec_row16_col3" class="data row16 col3">9.090840</td>
      <td id="T_579ec_row16_col4" class="data row16 col4">0.016672</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row17" class="row_heading level0 row17">FW</th>
      <td id="T_579ec_row17_col0" class="data row17 col0">490</td>
      <td id="T_579ec_row17_col1" class="data row17 col1"> foreign word</td>
      <td id="T_579ec_row17_col2" class="data row17 col2">0.000238</td>
      <td id="T_579ec_row17_col3" class="data row17 col3">12.036845</td>
      <td id="T_579ec_row17_col4" class="data row17 col4">0.002865</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row18" class="row_heading level0 row18">PO</th>
      <td id="T_579ec_row18_col0" class="data row18 col0">332</td>
      <td id="T_579ec_row18_col1" class="data row18 col1"> genitive marker</td>
      <td id="T_579ec_row18_col2" class="data row18 col2">0.000161</td>
      <td id="T_579ec_row18_col3" class="data row18 col3">12.598444</td>
      <td id="T_579ec_row18_col4" class="data row18 col4">0.002031</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row19" class="row_heading level0 row19">UH</th>
      <td id="T_579ec_row19_col0" class="data row19 col0">74</td>
      <td id="T_579ec_row19_col1" class="data row19 col1"> interjection</td>
      <td id="T_579ec_row19_col2" class="data row19 col2">0.000036</td>
      <td id="T_579ec_row19_col3" class="data row19 col3">14.764030</td>
      <td id="T_579ec_row19_col4" class="data row19 col4">0.000531</td>
    </tr>
    <tr>
      <th id="T_579ec_level0_row20" class="row_heading level0 row20">LS</th>
      <td id="T_579ec_row20_col0" class="data row20 col0">3</td>
      <td id="T_579ec_row20_col1" class="data row20 col1"> list item marker</td>
      <td id="T_579ec_row20_col2" class="data row20 col2">0.000001</td>
      <td id="T_579ec_row20_col3" class="data row20 col3">19.388520</td>
      <td id="T_579ec_row20_col4" class="data row20 col4">0.000028</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</section>
<section id="save" class="level2">
<h2 class="anchored" data-anchor-id="save">Save</h2>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>POS.to_csv(<span class="ss">f"</span><span class="sc">{</span>output_dir<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>data_prefix<span class="sc">}</span><span class="ss">-POS.csv"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>POS_GROUP.to_csv(<span class="ss">f"</span><span class="sc">{</span>output_dir<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>data_prefix<span class="sc">}</span><span class="ss">-POS_GROUP.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="extract-model-from-token" class="level1">
<h1>Extract Model from <code>TOKEN</code></h1>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>TOKEN <span class="op">=</span> TOKEN.join(POS, on<span class="op">=</span><span class="st">"pos_group"</span>, rsuffix<span class="op">=</span><span class="st">'_y'</span>).dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>TOKEN</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>pos_tuple</th>
      <th>pos</th>
      <th>token_str</th>
      <th>term_str</th>
      <th>pos_group</th>
      <th>def</th>
      <th>n</th>
      <th>pos_group_y</th>
    </tr>
    <tr>
      <th>book_id</th>
      <th>chap_id</th>
      <th>para_num</th>
      <th>sent_num</th>
      <th>token_num</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">105</th>
      <th rowspan="5" valign="top">1</th>
      <th rowspan="5" valign="top">1</th>
      <th rowspan="5" valign="top">0</th>
      <th>0</th>
      <td>('Sir', 'NNP')</td>
      <td>NNP</td>
      <td>Sir</td>
      <td>sir</td>
      <td>NN</td>
      <td>noun, common, singular or mass</td>
      <td>383976.0</td>
      <td>NN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>('Walter', 'NNP')</td>
      <td>NNP</td>
      <td>Walter</td>
      <td>walter</td>
      <td>NN</td>
      <td>noun, common, singular or mass</td>
      <td>383976.0</td>
      <td>NN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>('Elliot,', 'NNP')</td>
      <td>NNP</td>
      <td>Elliot,</td>
      <td>elliot</td>
      <td>NN</td>
      <td>noun, common, singular or mass</td>
      <td>383976.0</td>
      <td>NN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>('of', 'IN')</td>
      <td>IN</td>
      <td>of</td>
      <td>of</td>
      <td>IN</td>
      <td>preposition or conjunction, subordinating</td>
      <td>264122.0</td>
      <td>IN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>('Kellynch', 'NNP')</td>
      <td>NNP</td>
      <td>Kellynch</td>
      <td>kellynch</td>
      <td>NN</td>
      <td>noun, common, singular or mass</td>
      <td>383976.0</td>
      <td>NN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">34970</th>
      <th rowspan="5" valign="top">114</th>
      <th rowspan="5" valign="top">24</th>
      <th rowspan="5" valign="top">0</th>
      <th>6</th>
      <td>('The', 'DT')</td>
      <td>DT</td>
      <td>The</td>
      <td>the</td>
      <td>DT</td>
      <td>determiner</td>
      <td>204813.0</td>
      <td>DT</td>
    </tr>
    <tr>
      <th>7</th>
      <td>('Ambiguities,', 'NNP')</td>
      <td>NNP</td>
      <td>Ambiguities,</td>
      <td>ambiguities</td>
      <td>NN</td>
      <td>noun, common, singular or mass</td>
      <td>383976.0</td>
      <td>NN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>('by', 'IN')</td>
      <td>IN</td>
      <td>by</td>
      <td>by</td>
      <td>IN</td>
      <td>preposition or conjunction, subordinating</td>
      <td>264122.0</td>
      <td>IN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>('Herman', 'NNP')</td>
      <td>NNP</td>
      <td>Herman</td>
      <td>herman</td>
      <td>NN</td>
      <td>noun, common, singular or mass</td>
      <td>383976.0</td>
      <td>NN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>('Melville', 'NNP')</td>
      <td>NNP</td>
      <td>Melville</td>
      <td>melville</td>
      <td>NN</td>
      <td>noun, common, singular or mass</td>
      <td>383976.0</td>
      <td>NN</td>
    </tr>
  </tbody>
</table>
<p>1856907 rows  8 columns</p>
</div>
</div>
</div>
<p><img src="M04_02_HMM_files/figure-html/0cf42cca-f577-43f3-ab51-b558ef808664-1-5b0a81a3-9719-4fe3-9968-33500e54487b.png" class="img-fluid" alt="image.png"> <img src="images/hmm.png" width="750"></p>
<section id="create-table-of-t_n-rightarrow-t_n1-transissions-a" class="level2">
<h2 class="anchored" data-anchor-id="create-table-of-t_n-rightarrow-t_n1-transissions-a">Create Table of <span class="math inline">\(t_n \rightarrow t_{n+1}\)</span> Transissions (<span class="math inline">\(A\)</span>)</h2>
<p><strong>Add sentence boundaries to sequence</strong></p>
<p>Note that we are breaking our data by adding <code>&lt;s&gt;</code> as a key, although it is not part of the UPenn tagset. We might consider creating a code for sentence beginnings or endings, such as the stop tag in Eistenstein 2019.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> TOKEN[[<span class="st">'pos_group'</span>]].join(TOKEN[[<span class="st">'pos_group'</span>]].shift(<span class="op">-</span><span class="dv">1</span>), lsuffix<span class="op">=</span><span class="st">'_x'</span>, rsuffix<span class="op">=</span><span class="st">"_y"</span>)<span class="op">\</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    .value_counts().to_frame(<span class="st">'n'</span>).sort_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>A[<span class="st">'cp'</span>] <span class="op">=</span> A.n <span class="op">/</span> A.groupby(<span class="st">'pos_group_x'</span>).n.<span class="bu">sum</span>()  <span class="co"># P(y|x)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>n</th>
      <th>cp</th>
    </tr>
    <tr>
      <th>pos_group_x</th>
      <th>pos_group_y</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">CC</th>
      <th>CC</th>
      <td>117</td>
      <td>0.001402</td>
    </tr>
    <tr>
      <th>CD</th>
      <td>1162</td>
      <td>0.013925</td>
    </tr>
    <tr>
      <th>DT</th>
      <td>9585</td>
      <td>0.114859</td>
    </tr>
    <tr>
      <th>EX</th>
      <td>442</td>
      <td>0.005297</td>
    </tr>
    <tr>
      <th>FW</th>
      <td>1</td>
      <td>0.000012</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">WP</th>
      <th>MD</th>
      <td>1161</td>
      <td>0.107779</td>
    </tr>
    <tr>
      <th>NN</th>
      <td>1521</td>
      <td>0.141199</td>
    </tr>
    <tr>
      <th>RB</th>
      <td>525</td>
      <td>0.048737</td>
    </tr>
    <tr>
      <th>TO</th>
      <td>119</td>
      <td>0.011047</td>
    </tr>
    <tr>
      <th>VB</th>
      <td>5872</td>
      <td>0.545117</td>
    </tr>
  </tbody>
</table>
<p>205 rows  2 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>AM <span class="op">=</span> A.cp.unstack(fill_value<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>AM.style.background_gradient(axis<span class="op">=</span><span class="va">None</span>, cmap<span class="op">=</span>colors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">

<style type="text/css">
#T_d3806_row0_col0, #T_d3806_row0_col4, #T_d3806_row0_col7, #T_d3806_row0_col11, #T_d3806_row0_col13, #T_d3806_row1_col3, #T_d3806_row1_col4, #T_d3806_row1_col7, #T_d3806_row1_col11, #T_d3806_row1_col13, #T_d3806_row2_col0, #T_d3806_row2_col2, #T_d3806_row2_col3, #T_d3806_row2_col4, #T_d3806_row2_col7, #T_d3806_row2_col8, #T_d3806_row2_col11, #T_d3806_row2_col12, #T_d3806_row2_col13, #T_d3806_row2_col15, #T_d3806_row3_col0, #T_d3806_row3_col1, #T_d3806_row3_col3, #T_d3806_row3_col4, #T_d3806_row3_col7, #T_d3806_row3_col11, #T_d3806_row3_col12, #T_d3806_row3_col13, #T_d3806_row3_col15, #T_d3806_row4_col3, #T_d3806_row4_col7, #T_d3806_row4_col11, #T_d3806_row4_col13, #T_d3806_row4_col15, #T_d3806_row5_col3, #T_d3806_row5_col4, #T_d3806_row5_col7, #T_d3806_row5_col11, #T_d3806_row5_col13, #T_d3806_row6_col3, #T_d3806_row6_col4, #T_d3806_row6_col7, #T_d3806_row6_col11, #T_d3806_row6_col13, #T_d3806_row6_col15, #T_d3806_row7_col0, #T_d3806_row7_col1, #T_d3806_row7_col2, #T_d3806_row7_col3, #T_d3806_row7_col4, #T_d3806_row7_col6, #T_d3806_row7_col7, #T_d3806_row7_col8, #T_d3806_row7_col10, #T_d3806_row7_col11, #T_d3806_row7_col12, #T_d3806_row7_col13, #T_d3806_row7_col15, #T_d3806_row8_col1, #T_d3806_row8_col3, #T_d3806_row8_col4, #T_d3806_row8_col6, #T_d3806_row8_col7, #T_d3806_row8_col8, #T_d3806_row8_col11, #T_d3806_row8_col13, #T_d3806_row8_col15, #T_d3806_row9_col4, #T_d3806_row9_col7, #T_d3806_row9_col11, #T_d3806_row9_col13, #T_d3806_row10_col3, #T_d3806_row10_col4, #T_d3806_row10_col7, #T_d3806_row10_col11, #T_d3806_row10_col13, #T_d3806_row10_col15, #T_d3806_row11_col3, #T_d3806_row11_col4, #T_d3806_row11_col7, #T_d3806_row11_col8, #T_d3806_row11_col11, #T_d3806_row11_col13, #T_d3806_row12_col3, #T_d3806_row12_col4, #T_d3806_row12_col7, #T_d3806_row12_col8, #T_d3806_row12_col11, #T_d3806_row12_col12, #T_d3806_row12_col13, #T_d3806_row13_col0, #T_d3806_row13_col1, #T_d3806_row13_col3, #T_d3806_row13_col4, #T_d3806_row13_col7, #T_d3806_row13_col11, #T_d3806_row13_col13, #T_d3806_row13_col15, #T_d3806_row14_col3, #T_d3806_row14_col4, #T_d3806_row14_col7, #T_d3806_row14_col13, #T_d3806_row15_col1, #T_d3806_row15_col3, #T_d3806_row15_col4, #T_d3806_row15_col7, #T_d3806_row15_col11, #T_d3806_row15_col13, #T_d3806_row15_col15 {
  background-color: #ffffd9;
  color: #000000;
}
#T_d3806_row0_col1, #T_d3806_row2_col5, #T_d3806_row5_col8, #T_d3806_row8_col5, #T_d3806_row13_col2 {
  background-color: #fdfed4;
  color: #000000;
}
#T_d3806_row0_col2, #T_d3806_row9_col0 {
  background-color: #e8f6b1;
  color: #000000;
}
#T_d3806_row0_col3, #T_d3806_row4_col8, #T_d3806_row4_col12, #T_d3806_row5_col0, #T_d3806_row6_col1, #T_d3806_row8_col0, #T_d3806_row9_col1, #T_d3806_row9_col3, #T_d3806_row10_col1, #T_d3806_row12_col0, #T_d3806_row12_col1, #T_d3806_row12_col10, #T_d3806_row12_col15, #T_d3806_row14_col15, #T_d3806_row15_col0 {
  background-color: #feffd8;
  color: #000000;
}
#T_d3806_row0_col5, #T_d3806_row0_col10 {
  background-color: #ecf7b1;
  color: #000000;
}
#T_d3806_row0_col6, #T_d3806_row14_col6 {
  background-color: #eff9b6;
  color: #000000;
}
#T_d3806_row0_col8, #T_d3806_row4_col5, #T_d3806_row5_col10, #T_d3806_row6_col2, #T_d3806_row9_col6, #T_d3806_row10_col0, #T_d3806_row14_col0 {
  background-color: #fbfdd0;
  color: #000000;
}
#T_d3806_row0_col9, #T_d3806_row2_col6 {
  background-color: #a5dcb7;
  color: #000000;
}
#T_d3806_row0_col12, #T_d3806_row1_col12, #T_d3806_row2_col1, #T_d3806_row3_col6, #T_d3806_row5_col1, #T_d3806_row5_col12, #T_d3806_row8_col2, #T_d3806_row8_col12, #T_d3806_row10_col8, #T_d3806_row15_col12 {
  background-color: #fdfed5;
  color: #000000;
}
#T_d3806_row0_col14 {
  background-color: #90d4b9;
  color: #000000;
}
#T_d3806_row0_col15, #T_d3806_row1_col2, #T_d3806_row1_col15, #T_d3806_row5_col15, #T_d3806_row6_col8, #T_d3806_row8_col9, #T_d3806_row9_col15, #T_d3806_row11_col1, #T_d3806_row11_col15, #T_d3806_row14_col1, #T_d3806_row14_col8 {
  background-color: #feffd6;
  color: #000000;
}
#T_d3806_row1_col0, #T_d3806_row6_col14, #T_d3806_row15_col2 {
  background-color: #f4fbc1;
  color: #000000;
}
#T_d3806_row1_col1, #T_d3806_row1_col8, #T_d3806_row1_col10, #T_d3806_row3_col9, #T_d3806_row4_col1, #T_d3806_row12_col5 {
  background-color: #fcfed3;
  color: #000000;
}
#T_d3806_row1_col5 {
  background-color: #d4eeb3;
  color: #000000;
}
#T_d3806_row1_col6 {
  background-color: #edf8b2;
  color: #000000;
}
#T_d3806_row1_col9 {
  background-color: #1e8abd;
  color: #f1f1f1;
}
#T_d3806_row1_col14, #T_d3806_row13_col12 {
  background-color: #f1faba;
  color: #000000;
}
#T_d3806_row2_col9 {
  background-color: #24459c;
  color: #f1f1f1;
}
#T_d3806_row2_col10, #T_d3806_row3_col10, #T_d3806_row11_col0 {
  background-color: #fafdce;
  color: #000000;
}
#T_d3806_row2_col14, #T_d3806_row6_col12, #T_d3806_row9_col8, #T_d3806_row9_col12, #T_d3806_row15_col5 {
  background-color: #f9fdcc;
  color: #000000;
}
#T_d3806_row3_col2, #T_d3806_row13_col8, #T_d3806_row13_col14 {
  background-color: #fafdcf;
  color: #000000;
}
#T_d3806_row3_col5, #T_d3806_row6_col10, #T_d3806_row12_col6, #T_d3806_row14_col11 {
  background-color: #fcfed1;
  color: #000000;
}
#T_d3806_row3_col8, #T_d3806_row6_col5 {
  background-color: #eff9b5;
  color: #000000;
}
#T_d3806_row3_col14 {
  background-color: #081d58;
  color: #f1f1f1;
}
#T_d3806_row4_col0, #T_d3806_row9_col2, #T_d3806_row11_col14 {
  background-color: #f8fcc9;
  color: #000000;
}
#T_d3806_row4_col2 {
  background-color: #d0edb3;
  color: #000000;
}
#T_d3806_row4_col4, #T_d3806_row4_col10, #T_d3806_row11_col12 {
  background-color: #f5fbc2;
  color: #000000;
}
#T_d3806_row4_col6 {
  background-color: #f1fabb;
  color: #000000;
}
#T_d3806_row4_col9 {
  background-color: #36abc3;
  color: #f1f1f1;
}
#T_d3806_row4_col14, #T_d3806_row5_col14, #T_d3806_row15_col8 {
  background-color: #eaf7b1;
  color: #000000;
}
#T_d3806_row5_col2 {
  background-color: #59bfc0;
  color: #000000;
}
#T_d3806_row5_col5, #T_d3806_row13_col5, #T_d3806_row13_col10 {
  background-color: #f8fcca;
  color: #000000;
}
#T_d3806_row5_col6 {
  background-color: #eef8b3;
  color: #000000;
}
#T_d3806_row5_col9 {
  background-color: #73c8bd;
  color: #000000;
}
#T_d3806_row6_col0 {
  background-color: #f6fbc5;
  color: #000000;
}
#T_d3806_row6_col6 {
  background-color: #f3fabd;
  color: #000000;
}
#T_d3806_row6_col9 {
  background-color: #2350a1;
  color: #f1f1f1;
}
#T_d3806_row7_col5, #T_d3806_row7_col9, #T_d3806_row7_col14 {
  background-color: #6bc6be;
  color: #000000;
}
#T_d3806_row8_col10 {
  background-color: #9ed9b8;
  color: #000000;
}
#T_d3806_row8_col14 {
  background-color: #253795;
  color: #f1f1f1;
}
#T_d3806_row9_col5 {
  background-color: #a0dab8;
  color: #000000;
}
#T_d3806_row9_col9 {
  background-color: #bde5b5;
  color: #000000;
}
#T_d3806_row9_col10, #T_d3806_row10_col2, #T_d3806_row11_col6, #T_d3806_row11_col10, #T_d3806_row15_col10 {
  background-color: #f7fcc6;
  color: #000000;
}
#T_d3806_row9_col14 {
  background-color: #b7e3b6;
  color: #000000;
}
#T_d3806_row10_col5 {
  background-color: #e0f3b2;
  color: #000000;
}
#T_d3806_row10_col6 {
  background-color: #c8e9b4;
  color: #000000;
}
#T_d3806_row10_col9, #T_d3806_row15_col6 {
  background-color: #f7fcc7;
  color: #000000;
}
#T_d3806_row10_col10 {
  background-color: #e7f6b1;
  color: #000000;
}
#T_d3806_row10_col12 {
  background-color: #f9fdcb;
  color: #000000;
}
#T_d3806_row10_col14 {
  background-color: #52bcc2;
  color: #000000;
}
#T_d3806_row11_col2 {
  background-color: #b0e0b6;
  color: #000000;
}
#T_d3806_row11_col5 {
  background-color: #69c5be;
  color: #000000;
}
#T_d3806_row11_col9 {
  background-color: #cbebb4;
  color: #000000;
}
#T_d3806_row12_col2 {
  background-color: #d6efb3;
  color: #000000;
}
#T_d3806_row12_col9 {
  background-color: #edf8b1;
  color: #000000;
}
#T_d3806_row12_col14 {
  background-color: #243d98;
  color: #f1f1f1;
}
#T_d3806_row13_col6 {
  background-color: #f3fabf;
  color: #000000;
}
#T_d3806_row13_col9 {
  background-color: #233390;
  color: #f1f1f1;
}
#T_d3806_row14_col2, #T_d3806_row14_col14 {
  background-color: #daf0b3;
  color: #000000;
}
#T_d3806_row14_col5 {
  background-color: #cdebb4;
  color: #000000;
}
#T_d3806_row14_col9 {
  background-color: #d5efb3;
  color: #000000;
}
#T_d3806_row14_col10 {
  background-color: #e5f5b2;
  color: #000000;
}
#T_d3806_row14_col12 {
  background-color: #f4fbc0;
  color: #000000;
}
#T_d3806_row15_col9 {
  background-color: #ddf2b2;
  color: #000000;
}
#T_d3806_row15_col14 {
  background-color: #1f7ab5;
  color: #f1f1f1;
}
</style>
<table id="T_d3806">
  <thead>
    <tr>
      <th class="index_name level0">pos_group_y</th>
      <th id="T_d3806_level0_col0" class="col_heading level0 col0">CC</th>
      <th id="T_d3806_level0_col1" class="col_heading level0 col1">CD</th>
      <th id="T_d3806_level0_col2" class="col_heading level0 col2">DT</th>
      <th id="T_d3806_level0_col3" class="col_heading level0 col3">EX</th>
      <th id="T_d3806_level0_col4" class="col_heading level0 col4">FW</th>
      <th id="T_d3806_level0_col5" class="col_heading level0 col5">IN</th>
      <th id="T_d3806_level0_col6" class="col_heading level0 col6">JJ</th>
      <th id="T_d3806_level0_col7" class="col_heading level0 col7">LS</th>
      <th id="T_d3806_level0_col8" class="col_heading level0 col8">MD</th>
      <th id="T_d3806_level0_col9" class="col_heading level0 col9">NN</th>
      <th id="T_d3806_level0_col10" class="col_heading level0 col10">RB</th>
      <th id="T_d3806_level0_col11" class="col_heading level0 col11">RP</th>
      <th id="T_d3806_level0_col12" class="col_heading level0 col12">TO</th>
      <th id="T_d3806_level0_col13" class="col_heading level0 col13">UH</th>
      <th id="T_d3806_level0_col14" class="col_heading level0 col14">VB</th>
      <th id="T_d3806_level0_col15" class="col_heading level0 col15">WP</th>
    </tr>
    <tr>
      <th class="index_name level0">pos_group_x</th>
      <th class="blank col0">&nbsp;</th>
      <th class="blank col1">&nbsp;</th>
      <th class="blank col2">&nbsp;</th>
      <th class="blank col3">&nbsp;</th>
      <th class="blank col4">&nbsp;</th>
      <th class="blank col5">&nbsp;</th>
      <th class="blank col6">&nbsp;</th>
      <th class="blank col7">&nbsp;</th>
      <th class="blank col8">&nbsp;</th>
      <th class="blank col9">&nbsp;</th>
      <th class="blank col10">&nbsp;</th>
      <th class="blank col11">&nbsp;</th>
      <th class="blank col12">&nbsp;</th>
      <th class="blank col13">&nbsp;</th>
      <th class="blank col14">&nbsp;</th>
      <th class="blank col15">&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_d3806_level0_row0" class="row_heading level0 row0">CC</th>
      <td id="T_d3806_row0_col0" class="data row0 col0">0.001402</td>
      <td id="T_d3806_row0_col1" class="data row0 col1">0.013925</td>
      <td id="T_d3806_row0_col2" class="data row0 col2">0.114859</td>
      <td id="T_d3806_row0_col3" class="data row0 col3">0.005297</td>
      <td id="T_d3806_row0_col4" class="data row0 col4">0.000012</td>
      <td id="T_d3806_row0_col5" class="data row0 col5">0.105620</td>
      <td id="T_d3806_row0_col6" class="data row0 col6">0.088424</td>
      <td id="T_d3806_row0_col7" class="data row0 col7">0.000000</td>
      <td id="T_d3806_row0_col8" class="data row0 col8">0.024841</td>
      <td id="T_d3806_row0_col9" class="data row0 col9">0.248209</td>
      <td id="T_d3806_row0_col10" class="data row0 col10">0.103583</td>
      <td id="T_d3806_row0_col11" class="data row0 col11">0.000024</td>
      <td id="T_d3806_row0_col12" class="data row0 col12">0.010030</td>
      <td id="T_d3806_row0_col13" class="data row0 col13">0.000012</td>
      <td id="T_d3806_row0_col14" class="data row0 col14">0.275183</td>
      <td id="T_d3806_row0_col15" class="data row0 col15">0.008580</td>
    </tr>
    <tr>
      <th id="T_d3806_level0_row1" class="row_heading level0 row1">CD</th>
      <td id="T_d3806_row1_col0" class="data row1 col0">0.059794</td>
      <td id="T_d3806_row1_col1" class="data row1 col1">0.016098</td>
      <td id="T_d3806_row1_col2" class="data row1 col2">0.009120</td>
      <td id="T_d3806_row1_col3" class="data row1 col3">0.000397</td>
      <td id="T_d3806_row1_col4" class="data row1 col4">0.000079</td>
      <td id="T_d3806_row1_col5" class="data row1 col5">0.168438</td>
      <td id="T_d3806_row1_col6" class="data row1 col6">0.098652</td>
      <td id="T_d3806_row1_col7" class="data row1 col7">0.000000</td>
      <td id="T_d3806_row1_col8" class="data row1 col8">0.018002</td>
      <td id="T_d3806_row1_col9" class="data row1 col9">0.513561</td>
      <td id="T_d3806_row1_col10" class="data row1 col10">0.017684</td>
      <td id="T_d3806_row1_col11" class="data row1 col11">0.000159</td>
      <td id="T_d3806_row1_col12" class="data row1 col12">0.010706</td>
      <td id="T_d3806_row1_col13" class="data row1 col13">0.000000</td>
      <td id="T_d3806_row1_col14" class="data row1 col14">0.078588</td>
      <td id="T_d3806_row1_col15" class="data row1 col15">0.008723</td>
    </tr>
    <tr>
      <th id="T_d3806_level0_row2" class="row_heading level0 row2">DT</th>
      <td id="T_d3806_row2_col0" class="data row2 col0">0.001094</td>
      <td id="T_d3806_row2_col1" class="data row2 col1">0.009667</td>
      <td id="T_d3806_row2_col2" class="data row2 col2">0.002046</td>
      <td id="T_d3806_row2_col3" class="data row2 col3">0.000112</td>
      <td id="T_d3806_row2_col4" class="data row2 col4">0.000308</td>
      <td id="T_d3806_row2_col5" class="data row2 col5">0.013202</td>
      <td id="T_d3806_row2_col6" class="data row2 col6">0.247465</td>
      <td id="T_d3806_row2_col7" class="data row2 col7">0.000000</td>
      <td id="T_d3806_row2_col8" class="data row2 col8">0.002676</td>
      <td id="T_d3806_row2_col9" class="data row2 col9">0.658044</td>
      <td id="T_d3806_row2_col10" class="data row2 col10">0.028870</td>
      <td id="T_d3806_row2_col11" class="data row2 col11">0.000142</td>
      <td id="T_d3806_row2_col12" class="data row2 col12">0.001396</td>
      <td id="T_d3806_row2_col13" class="data row2 col13">0.000005</td>
      <td id="T_d3806_row2_col14" class="data row2 col14">0.033426</td>
      <td id="T_d3806_row2_col15" class="data row2 col15">0.001548</td>
    </tr>
    <tr>
      <th id="T_d3806_level0_row3" class="row_heading level0 row3">EX</th>
      <td id="T_d3806_row3_col0" class="data row3 col0">0.002119</td>
      <td id="T_d3806_row3_col1" class="data row3 col1">0.001324</td>
      <td id="T_d3806_row3_col2" class="data row3 col2">0.025424</td>
      <td id="T_d3806_row3_col3" class="data row3 col3">0.000000</td>
      <td id="T_d3806_row3_col4" class="data row3 col4">0.000000</td>
      <td id="T_d3806_row3_col5" class="data row3 col5">0.020922</td>
      <td id="T_d3806_row3_col6" class="data row3 col6">0.010593</td>
      <td id="T_d3806_row3_col7" class="data row3 col7">0.000000</td>
      <td id="T_d3806_row3_col8" class="data row3 col8">0.092956</td>
      <td id="T_d3806_row3_col9" class="data row3 col9">0.016419</td>
      <td id="T_d3806_row3_col10" class="data row3 col10">0.029396</td>
      <td id="T_d3806_row3_col11" class="data row3 col11">0.000000</td>
      <td id="T_d3806_row3_col12" class="data row3 col12">0.001589</td>
      <td id="T_d3806_row3_col13" class="data row3 col13">0.000000</td>
      <td id="T_d3806_row3_col14" class="data row3 col14">0.798994</td>
      <td id="T_d3806_row3_col15" class="data row3 col15">0.000265</td>
    </tr>
    <tr>
      <th id="T_d3806_level0_row4" class="row_heading level0 row4">FW</th>
      <td id="T_d3806_row4_col0" class="data row4 col0">0.040816</td>
      <td id="T_d3806_row4_col1" class="data row4 col1">0.018367</td>
      <td id="T_d3806_row4_col2" class="data row4 col2">0.175510</td>
      <td id="T_d3806_row4_col3" class="data row4 col3">0.000000</td>
      <td id="T_d3806_row4_col4" class="data row4 col4">0.057143</td>
      <td id="T_d3806_row4_col5" class="data row4 col5">0.022449</td>
      <td id="T_d3806_row4_col6" class="data row4 col6">0.075510</td>
      <td id="T_d3806_row4_col7" class="data row4 col7">0.000000</td>
      <td id="T_d3806_row4_col8" class="data row4 col8">0.006122</td>
      <td id="T_d3806_row4_col9" class="data row4 col9">0.430612</td>
      <td id="T_d3806_row4_col10" class="data row4 col10">0.059184</td>
      <td id="T_d3806_row4_col11" class="data row4 col11">0.002041</td>
      <td id="T_d3806_row4_col12" class="data row4 col12">0.004082</td>
      <td id="T_d3806_row4_col13" class="data row4 col13">0.000000</td>
      <td id="T_d3806_row4_col14" class="data row4 col14">0.108163</td>
      <td id="T_d3806_row4_col15" class="data row4 col15">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3806_level0_row5" class="row_heading level0 row5">IN</th>
      <td id="T_d3806_row5_col0" class="data row5 col0">0.003771</td>
      <td id="T_d3806_row5_col1" class="data row5 col1">0.012369</td>
      <td id="T_d3806_row5_col2" class="data row5 col2">0.361609</td>
      <td id="T_d3806_row5_col3" class="data row5 col3">0.002344</td>
      <td id="T_d3806_row5_col4" class="data row5 col4">0.000435</td>
      <td id="T_d3806_row5_col5" class="data row5 col5">0.039046</td>
      <td id="T_d3806_row5_col6" class="data row5 col6">0.095100</td>
      <td id="T_d3806_row5_col7" class="data row5 col7">0.000000</td>
      <td id="T_d3806_row5_col8" class="data row5 col8">0.013906</td>
      <td id="T_d3806_row5_col9" class="data row5 col9">0.320852</td>
      <td id="T_d3806_row5_col10" class="data row5 col10">0.024780</td>
      <td id="T_d3806_row5_col11" class="data row5 col11">0.000117</td>
      <td id="T_d3806_row5_col12" class="data row5 col12">0.009863</td>
      <td id="T_d3806_row5_col13" class="data row5 col13">0.000000</td>
      <td id="T_d3806_row5_col14" class="data row5 col14">0.109041</td>
      <td id="T_d3806_row5_col15" class="data row5 col15">0.006766</td>
    </tr>
    <tr>
      <th id="T_d3806_level0_row6" class="row_heading level0 row6">JJ</th>
      <td id="T_d3806_row6_col0" class="data row6 col0">0.050493</td>
      <td id="T_d3806_row6_col1" class="data row6 col1">0.005232</td>
      <td id="T_d3806_row6_col2" class="data row6 col2">0.024156</td>
      <td id="T_d3806_row6_col3" class="data row6 col3">0.000799</td>
      <td id="T_d3806_row6_col4" class="data row6 col4">0.000400</td>
      <td id="T_d3806_row6_col5" class="data row6 col5">0.091696</td>
      <td id="T_d3806_row6_col6" class="data row6 col6">0.070028</td>
      <td id="T_d3806_row6_col7" class="data row6 col7">0.000000</td>
      <td id="T_d3806_row6_col8" class="data row6 col8">0.009120</td>
      <td id="T_d3806_row6_col9" class="data row6 col9">0.630655</td>
      <td id="T_d3806_row6_col10" class="data row6 col10">0.021558</td>
      <td id="T_d3806_row6_col11" class="data row6 col11">0.000418</td>
      <td id="T_d3806_row6_col12" class="data row6 col12">0.033785</td>
      <td id="T_d3806_row6_col13" class="data row6 col13">0.000073</td>
      <td id="T_d3806_row6_col14" class="data row6 col14">0.060127</td>
      <td id="T_d3806_row6_col15" class="data row6 col15">0.001459</td>
    </tr>
    <tr>
      <th id="T_d3806_level0_row7" class="row_heading level0 row7">LS</th>
      <td id="T_d3806_row7_col0" class="data row7 col0">0.000000</td>
      <td id="T_d3806_row7_col1" class="data row7 col1">0.000000</td>
      <td id="T_d3806_row7_col2" class="data row7 col2">0.000000</td>
      <td id="T_d3806_row7_col3" class="data row7 col3">0.000000</td>
      <td id="T_d3806_row7_col4" class="data row7 col4">0.000000</td>
      <td id="T_d3806_row7_col5" class="data row7 col5">0.333333</td>
      <td id="T_d3806_row7_col6" class="data row7 col6">0.000000</td>
      <td id="T_d3806_row7_col7" class="data row7 col7">0.000000</td>
      <td id="T_d3806_row7_col8" class="data row7 col8">0.000000</td>
      <td id="T_d3806_row7_col9" class="data row7 col9">0.333333</td>
      <td id="T_d3806_row7_col10" class="data row7 col10">0.000000</td>
      <td id="T_d3806_row7_col11" class="data row7 col11">0.000000</td>
      <td id="T_d3806_row7_col12" class="data row7 col12">0.000000</td>
      <td id="T_d3806_row7_col13" class="data row7 col13">0.000000</td>
      <td id="T_d3806_row7_col14" class="data row7 col14">0.333333</td>
      <td id="T_d3806_row7_col15" class="data row7 col15">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3806_level0_row8" class="row_heading level0 row8">MD</th>
      <td id="T_d3806_row8_col0" class="data row8 col0">0.004674</td>
      <td id="T_d3806_row8_col1" class="data row8 col1">0.000784</td>
      <td id="T_d3806_row8_col2" class="data row8 col2">0.011796</td>
      <td id="T_d3806_row8_col3" class="data row8 col3">0.000063</td>
      <td id="T_d3806_row8_col4" class="data row8 col4">0.000000</td>
      <td id="T_d3806_row8_col5" class="data row8 col5">0.013333</td>
      <td id="T_d3806_row8_col6" class="data row8 col6">0.001286</td>
      <td id="T_d3806_row8_col7" class="data row8 col7">0.000000</td>
      <td id="T_d3806_row8_col8" class="data row8 col8">0.000345</td>
      <td id="T_d3806_row8_col9" class="data row8 col9">0.008094</td>
      <td id="T_d3806_row8_col10" class="data row8 col10">0.256431</td>
      <td id="T_d3806_row8_col11" class="data row8 col11">0.000094</td>
      <td id="T_d3806_row8_col12" class="data row8 col12">0.011890</td>
      <td id="T_d3806_row8_col13" class="data row8 col13">0.000000</td>
      <td id="T_d3806_row8_col14" class="data row8 col14">0.691021</td>
      <td id="T_d3806_row8_col15" class="data row8 col15">0.000188</td>
    </tr>
    <tr>
      <th id="T_d3806_level0_row9" class="row_heading level0 row9">NN</th>
      <td id="T_d3806_row9_col0" class="data row9 col0">0.112549</td>
      <td id="T_d3806_row9_col1" class="data row9 col1">0.003248</td>
      <td id="T_d3806_row9_col2" class="data row9 col2">0.042404</td>
      <td id="T_d3806_row9_col3" class="data row9 col3">0.003133</td>
      <td id="T_d3806_row9_col4" class="data row9 col4">0.000320</td>
      <td id="T_d3806_row9_col5" class="data row9 col5">0.255391</td>
      <td id="T_d3806_row9_col6" class="data row9 col6">0.022146</td>
      <td id="T_d3806_row9_col7" class="data row9 col7">0.000006</td>
      <td id="T_d3806_row9_col8" class="data row9 col8">0.032759</td>
      <td id="T_d3806_row9_col9" class="data row9 col9">0.214466</td>
      <td id="T_d3806_row9_col10" class="data row9 col10">0.049440</td>
      <td id="T_d3806_row9_col11" class="data row9 col11">0.000640</td>
      <td id="T_d3806_row9_col12" class="data row9 col12">0.032720</td>
      <td id="T_d3806_row9_col13" class="data row9 col13">0.000081</td>
      <td id="T_d3806_row9_col14" class="data row9 col14">0.221690</td>
      <td id="T_d3806_row9_col15" class="data row9 col15">0.009007</td>
    </tr>
    <tr>
      <th id="T_d3806_level0_row10" class="row_heading level0 row10">RB</th>
      <td id="T_d3806_row10_col0" class="data row10 col0">0.022930</td>
      <td id="T_d3806_row10_col1" class="data row10 col1">0.005342</td>
      <td id="T_d3806_row10_col2" class="data row10 col2">0.047917</td>
      <td id="T_d3806_row10_col3" class="data row10 col3">0.001764</td>
      <td id="T_d3806_row10_col4" class="data row10 col4">0.000025</td>
      <td id="T_d3806_row10_col5" class="data row10 col5">0.135000</td>
      <td id="T_d3806_row10_col6" class="data row10 col6">0.198019</td>
      <td id="T_d3806_row10_col7" class="data row10 col7">0.000000</td>
      <td id="T_d3806_row10_col8" class="data row10 col8">0.012481</td>
      <td id="T_d3806_row10_col9" class="data row10 col9">0.046229</td>
      <td id="T_d3806_row10_col10" class="data row10 col10">0.117471</td>
      <td id="T_d3806_row10_col11" class="data row10 col11">0.000596</td>
      <td id="T_d3806_row10_col12" class="data row10 col12">0.035319</td>
      <td id="T_d3806_row10_col13" class="data row10 col13">0.000000</td>
      <td id="T_d3806_row10_col14" class="data row10 col14">0.374386</td>
      <td id="T_d3806_row10_col15" class="data row10 col15">0.002520</td>
    </tr>
    <tr>
      <th id="T_d3806_level0_row11" class="row_heading level0 row11">RP</th>
      <td id="T_d3806_row11_col0" class="data row11 col0">0.028365</td>
      <td id="T_d3806_row11_col1" class="data row11 col1">0.008231</td>
      <td id="T_d3806_row11_col2" class="data row11 col2">0.231100</td>
      <td id="T_d3806_row11_col3" class="data row11 col3">0.000253</td>
      <td id="T_d3806_row11_col4" class="data row11 col4">0.000127</td>
      <td id="T_d3806_row11_col5" class="data row11 col5">0.335064</td>
      <td id="T_d3806_row11_col6" class="data row11 col6">0.048626</td>
      <td id="T_d3806_row11_col7" class="data row11 col7">0.000000</td>
      <td id="T_d3806_row11_col8" class="data row11 col8">0.003039</td>
      <td id="T_d3806_row11_col9" class="data row11 col9">0.189439</td>
      <td id="T_d3806_row11_col10" class="data row11 col10">0.048499</td>
      <td id="T_d3806_row11_col11" class="data row11 col11">0.000380</td>
      <td id="T_d3806_row11_col12" class="data row11 col12">0.057110</td>
      <td id="T_d3806_row11_col13" class="data row11 col13">0.000000</td>
      <td id="T_d3806_row11_col14" class="data row11 col14">0.042801</td>
      <td id="T_d3806_row11_col15" class="data row11 col15">0.006965</td>
    </tr>
    <tr>
      <th id="T_d3806_level0_row12" class="row_heading level0 row12">TO</th>
      <td id="T_d3806_row12_col0" class="data row12 col0">0.003634</td>
      <td id="T_d3806_row12_col1" class="data row12 col1">0.004516</td>
      <td id="T_d3806_row12_col2" class="data row12 col2">0.161764</td>
      <td id="T_d3806_row12_col3" class="data row12 col3">0.000162</td>
      <td id="T_d3806_row12_col4" class="data row12 col4">0.000036</td>
      <td id="T_d3806_row12_col5" class="data row12 col5">0.015887</td>
      <td id="T_d3806_row12_col6" class="data row12 col6">0.020798</td>
      <td id="T_d3806_row12_col7" class="data row12 col7">0.000000</td>
      <td id="T_d3806_row12_col8" class="data row12 col8">0.000990</td>
      <td id="T_d3806_row12_col9" class="data row12 col9">0.101779</td>
      <td id="T_d3806_row12_col10" class="data row12 col10">0.005416</td>
      <td id="T_d3806_row12_col11" class="data row12 col11">0.000414</td>
      <td id="T_d3806_row12_col12" class="data row12 col12">0.001727</td>
      <td id="T_d3806_row12_col13" class="data row12 col13">0.000000</td>
      <td id="T_d3806_row12_col14" class="data row12 col14">0.676940</td>
      <td id="T_d3806_row12_col15" class="data row12 col15">0.005937</td>
    </tr>
    <tr>
      <th id="T_d3806_level0_row13" class="row_heading level0 row13">UH</th>
      <td id="T_d3806_row13_col0" class="data row13 col0">0.000000</td>
      <td id="T_d3806_row13_col1" class="data row13 col1">0.000000</td>
      <td id="T_d3806_row13_col2" class="data row13 col2">0.013514</td>
      <td id="T_d3806_row13_col3" class="data row13 col3">0.000000</td>
      <td id="T_d3806_row13_col4" class="data row13 col4">0.000000</td>
      <td id="T_d3806_row13_col5" class="data row13 col5">0.040541</td>
      <td id="T_d3806_row13_col6" class="data row13 col6">0.067568</td>
      <td id="T_d3806_row13_col7" class="data row13 col7">0.000000</td>
      <td id="T_d3806_row13_col8" class="data row13 col8">0.027027</td>
      <td id="T_d3806_row13_col9" class="data row13 col9">0.702703</td>
      <td id="T_d3806_row13_col10" class="data row13 col10">0.040541</td>
      <td id="T_d3806_row13_col11" class="data row13 col11">0.000000</td>
      <td id="T_d3806_row13_col12" class="data row13 col12">0.081081</td>
      <td id="T_d3806_row13_col13" class="data row13 col13">0.000000</td>
      <td id="T_d3806_row13_col14" class="data row13 col14">0.027027</td>
      <td id="T_d3806_row13_col15" class="data row13 col15">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3806_level0_row14" class="row_heading level0 row14">VB</th>
      <td id="T_d3806_row14_col0" class="data row14 col0">0.024745</td>
      <td id="T_d3806_row14_col1" class="data row14 col1">0.006602</td>
      <td id="T_d3806_row14_col2" class="data row14 col2">0.152842</td>
      <td id="T_d3806_row14_col3" class="data row14 col3">0.001760</td>
      <td id="T_d3806_row14_col4" class="data row14 col4">0.000095</td>
      <td id="T_d3806_row14_col5" class="data row14 col5">0.186478</td>
      <td id="T_d3806_row14_col6" class="data row14 col6">0.088134</td>
      <td id="T_d3806_row14_col7" class="data row14 col7">0.000000</td>
      <td id="T_d3806_row14_col8" class="data row14 col8">0.008558</td>
      <td id="T_d3806_row14_col9" class="data row14 col9">0.164949</td>
      <td id="T_d3806_row14_col10" class="data row14 col10">0.123140</td>
      <td id="T_d3806_row14_col11" class="data row14 col11">0.020503</td>
      <td id="T_d3806_row14_col12" class="data row14 col12">0.064991</td>
      <td id="T_d3806_row14_col13" class="data row14 col13">0.000045</td>
      <td id="T_d3806_row14_col14" class="data row14 col14">0.151438</td>
      <td id="T_d3806_row14_col15" class="data row14 col15">0.005722</td>
    </tr>
    <tr>
      <th id="T_d3806_level0_row15" class="row_heading level0 row15">WP</th>
      <td id="T_d3806_row15_col0" class="data row15 col0">0.003620</td>
      <td id="T_d3806_row15_col1" class="data row15 col1">0.002971</td>
      <td id="T_d3806_row15_col2" class="data row15 col2">0.060899</td>
      <td id="T_d3806_row15_col3" class="data row15 col3">0.001021</td>
      <td id="T_d3806_row15_col4" class="data row15 col4">0.000278</td>
      <td id="T_d3806_row15_col5" class="data row15 col5">0.032306</td>
      <td id="T_d3806_row15_col6" class="data row15 col6">0.045024</td>
      <td id="T_d3806_row15_col7" class="data row15 col7">0.000000</td>
      <td id="T_d3806_row15_col8" class="data row15 col8">0.107779</td>
      <td id="T_d3806_row15_col9" class="data row15 col9">0.141199</td>
      <td id="T_d3806_row15_col10" class="data row15 col10">0.048737</td>
      <td id="T_d3806_row15_col11" class="data row15 col11">0.000000</td>
      <td id="T_d3806_row15_col12" class="data row15 col12">0.011047</td>
      <td id="T_d3806_row15_col13" class="data row15 col13">0.000000</td>
      <td id="T_d3806_row15_col14" class="data row15 col14">0.545117</td>
      <td id="T_d3806_row15_col15" class="data row15 col15">0.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</section>
<section id="create-table-of-initial-state-probabilities-pi" class="level2">
<h2 class="anchored" data-anchor-id="create-table-of-initial-state-probabilities-pi">Create Table of Initial State Probabilities <span class="math inline">\(\Pi\)</span></h2>
<p>We get counts of pos tags that appear at the beginnings of sentences.</p>
<p>Note: since we took the trouble to create an OHCO index, we dont need to add <code>&lt;s&gt;</code> markers to find out these frequencies.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>PI <span class="op">=</span> TOKEN.query(<span class="st">"token_num == 0"</span>).pos_group.value_counts().to_frame(<span class="st">'n'</span>).sort_index()</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>PI.index.name <span class="op">=</span> <span class="st">'pos_group'</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>PI[<span class="st">'cp'</span>] <span class="op">=</span> PI.n <span class="op">/</span> PI.n.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="make-sure-shares-sample-space-with-a-and-b" class="level2">
<h2 class="anchored" data-anchor-id="make-sure-shares-sample-space-with-a-and-b">Make sure $$ shares sample space with <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span></h2>
<p>Find out what is missing from PI.<br>
This will be important below.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tag <span class="kw">in</span> (<span class="bu">set</span>(AM.index) <span class="op">-</span> <span class="bu">set</span>(PI.index)):</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    PI.loc[tag, [<span class="st">'n'</span>, <span class="st">'cp'</span>]] <span class="op">=</span> (<span class="dv">0</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>PI</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>n</th>
      <th>cp</th>
    </tr>
    <tr>
      <th>pos_group</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CC</th>
      <td>7864.0</td>
      <td>0.107079</td>
    </tr>
    <tr>
      <th>CD</th>
      <td>743.0</td>
      <td>0.010117</td>
    </tr>
    <tr>
      <th>DT</th>
      <td>9868.0</td>
      <td>0.134366</td>
    </tr>
    <tr>
      <th>EX</th>
      <td>917.0</td>
      <td>0.012486</td>
    </tr>
    <tr>
      <th>FW</th>
      <td>8.0</td>
      <td>0.000109</td>
    </tr>
    <tr>
      <th>IN</th>
      <td>10245.0</td>
      <td>0.139500</td>
    </tr>
    <tr>
      <th>JJ</th>
      <td>4380.0</td>
      <td>0.059640</td>
    </tr>
    <tr>
      <th>LS</th>
      <td>3.0</td>
      <td>0.000041</td>
    </tr>
    <tr>
      <th>MD</th>
      <td>418.0</td>
      <td>0.005692</td>
    </tr>
    <tr>
      <th>NN</th>
      <td>25604.0</td>
      <td>0.348634</td>
    </tr>
    <tr>
      <th>RB</th>
      <td>5347.0</td>
      <td>0.072807</td>
    </tr>
    <tr>
      <th>TO</th>
      <td>745.0</td>
      <td>0.010144</td>
    </tr>
    <tr>
      <th>UH</th>
      <td>50.0</td>
      <td>0.000681</td>
    </tr>
    <tr>
      <th>VB</th>
      <td>6309.0</td>
      <td>0.085906</td>
    </tr>
    <tr>
      <th>WP</th>
      <td>940.0</td>
      <td>0.012799</td>
    </tr>
    <tr>
      <th>RP</th>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>PI.sort_values(<span class="st">'cp'</span>, ascending<span class="op">=</span><span class="va">True</span>).cp.plot.barh()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="M04_02_HMM_files/figure-html/cell-29-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="create-table-of-t_n-rightarrow-o_n-emissions-b" class="level2">
<h2 class="anchored" data-anchor-id="create-table-of-t_n-rightarrow-o_n-emissions-b">Create Table of <span class="math inline">\(t_n \rightarrow o_n\)</span> Emissions ($ B $)</h2>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> TOKEN[[<span class="st">'pos_group'</span>, <span class="st">'term_str'</span>]].value_counts().to_frame(<span class="st">'n'</span>).sort_index()</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>B.index.names <span class="op">=</span> [<span class="st">'pos_group_y'</span>, <span class="st">'term_str'</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>B[<span class="st">'cp'</span>] <span class="op">=</span> B.n <span class="op">/</span> B.groupby(<span class="st">'pos_group_y'</span>).n.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>B.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>n</th>
      <th>cp</th>
    </tr>
    <tr>
      <th>pos_group_y</th>
      <th>term_str</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">CC</th>
      <th>acquired</th>
      <td>1</td>
      <td>0.000012</td>
    </tr>
    <tr>
      <th>ah</th>
      <td>1</td>
      <td>0.000012</td>
    </tr>
    <tr>
      <th>all</th>
      <td>2</td>
      <td>0.000024</td>
    </tr>
    <tr>
      <th>altogether</th>
      <td>3</td>
      <td>0.000036</td>
    </tr>
    <tr>
      <th>and</th>
      <td>60705</td>
      <td>0.727442</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>BM <span class="op">=</span> B.cp.unstack(fill_value<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>BM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>term_str</th>
      <th>0</th>
      <th>1</th>
      <th>10</th>
      <th>100</th>
      <th>1000</th>
      <th>10000</th>
      <th>10000000</th>
      <th>10440</th>
      <th>10800</th>
      <th>10th</th>
      <th>...</th>
      <th>zoroaster</th>
      <th>zozo</th>
      <th>zuma</th>
      <th>zur</th>
      <th></th>
      <th>neas</th>
      <th>niad</th>
      <th>son</th>
      <th>sops</th>
      <th>20000</th>
    </tr>
    <tr>
      <th>pos_group_y</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CC</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>CD</th>
      <td>0.000159</td>
      <td>0.001348</td>
      <td>0.000476</td>
      <td>0.000159</td>
      <td>0.000159</td>
      <td>0.000238</td>
      <td>0.000079</td>
      <td>0.000079</td>
      <td>0.000159</td>
      <td>0.000079</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>DT</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>EX</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>FW</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>IN</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>JJ</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000006</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>LS</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>MD</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>NN</th>
      <td>0.000000</td>
      <td>0.000011</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000002</td>
      <td>...</td>
      <td>0.000004</td>
      <td>0.000000</td>
      <td>0.000015</td>
      <td>0.000004</td>
      <td>0.000007</td>
      <td>0.000002</td>
      <td>0.000002</td>
      <td>0.000004</td>
      <td>0.000002</td>
      <td>0.000002</td>
    </tr>
    <tr>
      <th>RB</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>RP</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>TO</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>UH</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>VB</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000003</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>WP</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>16 rows  40262 columns</p>
</div>
</div>
</div>
</section>
<section id="put-into-single-model-hmm" class="level2">
<h2 class="anchored" data-anchor-id="put-into-single-model-hmm">Put into single model <code>HMM</code></h2>
<p>For convenience, bind the tables into signle model table.</p>
<div class="cell" data-tags="[]" data-execution_count="33">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>HMM <span class="op">=</span> pd.concat([AM, PI.cp, BM], keys<span class="op">=</span>[<span class="st">'trans'</span>,<span class="st">'start'</span>,<span class="st">'emit'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HMM.start</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="prepare-test-data" class="level1">
<h1>Prepare Test Data</h1>
<p>Import file of raw test sentences.</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>test_sentences <span class="op">=</span> [s.strip() <span class="cf">for</span> s <span class="kw">in</span> <span class="bu">open</span>(<span class="ss">f"</span><span class="sc">{</span>data_home<span class="sc">}</span><span class="ss">/misc/test_sentences.txt"</span>).readlines()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create dataframe of sentences. We will add features here later.</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>TEST_SENTENCES <span class="op">=</span> pd.DataFrame({<span class="st">'sent_str'</span>:test_sentences})</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>TEST_SENTENCES.index.name <span class="op">=</span> <span class="st">'sent_id'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>TEST_SENTENCES.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sent_str</th>
    </tr>
    <tr>
      <th>sent_id</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>the quick brown fox jumped over the lazy dogs</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The event had every promise of happiness for h...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mr Weston was a man of unexceptionable charact...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>but it was a black morning's work for her</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The want of Miss Taylor would be felt every ho...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Convert sentences to tokens (and terms).</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>TEST_TOKENS <span class="op">=</span> TEST_SENTENCES.sent_str.<span class="bu">apply</span>(<span class="kw">lambda</span> x: pd.Series(x.split())).stack().to_frame(<span class="st">'token_str'</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>TEST_TOKENS.index.names <span class="op">=</span> [<span class="st">'sent_id'</span>, <span class="st">'token_num'</span>]</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>TEST_TOKENS[<span class="st">'term_str'</span>] <span class="op">=</span> TEST_TOKENS.token_str.<span class="bu">str</span>.replace(<span class="vs">r"[\W_]+"</span>, <span class="st">""</span>, regex<span class="op">=</span><span class="va">True</span>).<span class="bu">str</span>.lower()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>TEST_TOKENS.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>token_str</th>
      <th>term_str</th>
    </tr>
    <tr>
      <th>sent_id</th>
      <th>token_num</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">0</th>
      <th>0</th>
      <td>the</td>
      <td>the</td>
    </tr>
    <tr>
      <th>1</th>
      <td>quick</td>
      <td>quick</td>
    </tr>
    <tr>
      <th>2</th>
      <td>brown</td>
      <td>brown</td>
    </tr>
    <tr>
      <th>3</th>
      <td>fox</td>
      <td>fox</td>
    </tr>
    <tr>
      <th>4</th>
      <td>jumped</td>
      <td>jumped</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="the-viterbi-algorithm" class="level1">
<h1>The Viterbi Algorithm</h1>
<p>The Vertibi implements the optimization function:</p>
<p><img src="images/formula.png" width="400"></p>
<p><img src="images/viterbi.png" width="750"></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="M04_02_HMM_files/figure-html/06fb006c-2597-40c4-babf-de96ac702420-1-379dac9c-cc76-4e48-a9e1-867c8c2d0078.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image.png</figcaption><p></p>
</figure>
</div>
<p><strong>Translation to NLP use case</strong>:</p>
<p><span class="math inline">\(Q \rightarrow\)</span> A set of <span class="math inline">\(N\)</span> POS tags.<br>
<span class="math inline">\(O \rightarrow\)</span> A sequence of <span class="math inline">\(T\)</span> tokens that compose a sentence.<br>
<span class="math inline">\(A \rightarrow\)</span> POS to POS table <span class="math inline">\(P(q_i|q_{i-1})\)</span>.<br>
<span class="math inline">\(B \rightarrow\)</span> POS to word table <span class="math inline">\(P(w_i|q_i)\)</span>.<br>
<span class="math inline">\(\Pi \rightarrow\)</span> Probabilites of POS as tag for first token.</p>
<section id="define-function" class="level2">
<h2 class="anchored" data-anchor-id="define-function">Define function</h2>
<div class="cell" data-tags="[]" data-execution_count="40">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(obs, HMM):</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Import model</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> HMM.index.to_list()</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    start_prob <span class="op">=</span> HMM.start.cp</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    trans_prob <span class="op">=</span> HMM.trans</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    emit_prob <span class="op">=</span> HMM.emit</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set up Viterbi lattice</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    V <span class="op">=</span> pd.DataFrame(np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(obs))), </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                     columns<span class="op">=</span><span class="bu">range</span>(<span class="bu">len</span>(obs)), </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>                     index<span class="op">=</span>states)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the first observation</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    V[<span class="dv">0</span>] <span class="op">=</span> start_prob <span class="op">*</span> emit_prob[obs[<span class="dv">0</span>]]</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate over the remaining observations</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t, o <span class="kw">in</span> <span class="bu">enumerate</span>(obs[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Simple method -- works OK</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># V[t] = trans_probs[V[t-1].idxmax()] * emit_probs[o]</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> s <span class="kw">in</span> states:</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>                V.loc[s, t] <span class="op">=</span> (V[t<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> trans_prob[s] <span class="op">*</span> emit_prob.loc[s, o]).<span class="bu">max</span>()</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">KeyError</span>:</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>                V.loc[s, t] <span class="op">=</span> (V[t<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> trans_prob[s]).<span class="bu">max</span>() <span class="co"># Fallback of word is OOV</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> V</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>obs</code> is a list representing the sequence of observed events <span class="math inline">\(O\)</span></li>
<li><code>states</code> is a list of the hidden states <span class="math inline">\(Q\)</span></li>
<li><code>start_prob</code> is a pandas Series representing the probability distribution over the states at time 0 <span class="math inline">\(\Pi\)</span></li>
<li><code>trans_prob</code> is a pandas DataFrame representing the transition probability matrix <span class="math inline">\(A\)</span></li>
<li><code>emit_prob</code> is a pandas DataFrame representing the emission probability matrix <span class="math inline">\(B\)</span></li>
</ul>
<p>The function returns a data frame of the Viterbi lattice, which can be used to compute most likely sequence of hidden states that generated the observed events.</p>
</section>
<section id="test-with-one-sentence" class="level2">
<h2 class="anchored" data-anchor-id="test-with-one-sentence">Test with one sentence</h2>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>test_observations <span class="op">=</span> TEST_TOKENS.loc[TEST_SENTENCES.sample().index[<span class="dv">0</span>]].term_str.to_list()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>V <span class="op">=</span> viterbi(test_observations, HMM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>pd.concat([pd.Series(test_observations), V.idxmax()], keys<span class="op">=</span>[<span class="st">'obs'</span>, <span class="st">'tag'</span>], axis<span class="op">=</span><span class="dv">1</span>).T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>obs</th>
      <td>mr</td>
      <td>weston</td>
      <td>was</td>
      <td>a</td>
      <td>man</td>
      <td>of</td>
      <td>unexceptionable</td>
      <td>character</td>
      <td>easy</td>
      <td>fortune</td>
      <td>suitable</td>
      <td>age</td>
      <td>and</td>
      <td>pleasant</td>
      <td>manners</td>
    </tr>
    <tr>
      <th>tag</th>
      <td>NN</td>
      <td>NN</td>
      <td>VB</td>
      <td>DT</td>
      <td>NN</td>
      <td>IN</td>
      <td>JJ</td>
      <td>NN</td>
      <td>JJ</td>
      <td>NN</td>
      <td>JJ</td>
      <td>NN</td>
      <td>CC</td>
      <td>JJ</td>
      <td>NN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> w, k <span class="kw">in</span> <span class="bu">zip</span>(test_observations, V.idxmax().values):</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>w<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">"</span>, end<span class="op">=</span><span class="st">' '</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mr/NN weston/NN was/VB a/DT man/NN of/IN unexceptionable/JJ character/NN easy/JJ fortune/NN suitable/JJ age/NN and/CC pleasant/JJ manners/NN </code></pre>
</div>
</div>
</section>
<section id="diminishing-probabilities" class="level2">
<h2 class="anchored" data-anchor-id="diminishing-probabilities">Diminishing probabilities</h2>
<p>Note diminishing probabilities in the lattice.</p>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>V.style.background_gradient(cmap<span class="op">=</span>colors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">

<style type="text/css">
#T_d3385_row0_col0, #T_d3385_row0_col1, #T_d3385_row0_col2, #T_d3385_row0_col3, #T_d3385_row0_col4, #T_d3385_row0_col5, #T_d3385_row0_col6, #T_d3385_row0_col7, #T_d3385_row0_col8, #T_d3385_row0_col9, #T_d3385_row0_col10, #T_d3385_row0_col11, #T_d3385_row0_col13, #T_d3385_row0_col14, #T_d3385_row1_col0, #T_d3385_row1_col1, #T_d3385_row1_col2, #T_d3385_row1_col3, #T_d3385_row1_col4, #T_d3385_row1_col5, #T_d3385_row1_col6, #T_d3385_row1_col7, #T_d3385_row1_col8, #T_d3385_row1_col9, #T_d3385_row1_col10, #T_d3385_row1_col11, #T_d3385_row1_col12, #T_d3385_row1_col13, #T_d3385_row1_col14, #T_d3385_row2_col0, #T_d3385_row2_col1, #T_d3385_row2_col2, #T_d3385_row2_col4, #T_d3385_row2_col5, #T_d3385_row2_col6, #T_d3385_row2_col7, #T_d3385_row2_col8, #T_d3385_row2_col9, #T_d3385_row2_col10, #T_d3385_row2_col11, #T_d3385_row2_col12, #T_d3385_row2_col13, #T_d3385_row2_col14, #T_d3385_row3_col0, #T_d3385_row3_col1, #T_d3385_row3_col2, #T_d3385_row3_col3, #T_d3385_row3_col4, #T_d3385_row3_col5, #T_d3385_row3_col6, #T_d3385_row3_col7, #T_d3385_row3_col8, #T_d3385_row3_col9, #T_d3385_row3_col10, #T_d3385_row3_col11, #T_d3385_row3_col12, #T_d3385_row3_col13, #T_d3385_row3_col14, #T_d3385_row4_col0, #T_d3385_row4_col1, #T_d3385_row4_col2, #T_d3385_row4_col3, #T_d3385_row4_col4, #T_d3385_row4_col5, #T_d3385_row4_col6, #T_d3385_row4_col7, #T_d3385_row4_col8, #T_d3385_row4_col9, #T_d3385_row4_col10, #T_d3385_row4_col11, #T_d3385_row4_col12, #T_d3385_row4_col13, #T_d3385_row4_col14, #T_d3385_row5_col0, #T_d3385_row5_col1, #T_d3385_row5_col2, #T_d3385_row5_col3, #T_d3385_row5_col4, #T_d3385_row5_col6, #T_d3385_row5_col7, #T_d3385_row5_col8, #T_d3385_row5_col9, #T_d3385_row5_col10, #T_d3385_row5_col11, #T_d3385_row5_col12, #T_d3385_row5_col13, #T_d3385_row5_col14, #T_d3385_row6_col1, #T_d3385_row6_col2, #T_d3385_row6_col3, #T_d3385_row6_col5, #T_d3385_row6_col7, #T_d3385_row6_col12, #T_d3385_row6_col14, #T_d3385_row7_col0, #T_d3385_row7_col1, #T_d3385_row7_col2, #T_d3385_row7_col3, #T_d3385_row7_col4, #T_d3385_row7_col5, #T_d3385_row7_col6, #T_d3385_row7_col7, #T_d3385_row7_col8, #T_d3385_row7_col9, #T_d3385_row7_col10, #T_d3385_row7_col11, #T_d3385_row7_col12, #T_d3385_row7_col13, #T_d3385_row7_col14, #T_d3385_row8_col0, #T_d3385_row8_col1, #T_d3385_row8_col2, #T_d3385_row8_col3, #T_d3385_row8_col4, #T_d3385_row8_col5, #T_d3385_row8_col6, #T_d3385_row8_col7, #T_d3385_row8_col8, #T_d3385_row8_col9, #T_d3385_row8_col10, #T_d3385_row8_col11, #T_d3385_row8_col12, #T_d3385_row8_col13, #T_d3385_row8_col14, #T_d3385_row9_col3, #T_d3385_row9_col5, #T_d3385_row9_col6, #T_d3385_row10_col0, #T_d3385_row10_col1, #T_d3385_row10_col2, #T_d3385_row10_col3, #T_d3385_row10_col4, #T_d3385_row10_col5, #T_d3385_row10_col6, #T_d3385_row10_col7, #T_d3385_row10_col9, #T_d3385_row10_col10, #T_d3385_row10_col11, #T_d3385_row10_col12, #T_d3385_row10_col14, #T_d3385_row11_col0, #T_d3385_row11_col1, #T_d3385_row11_col2, #T_d3385_row11_col3, #T_d3385_row11_col4, #T_d3385_row11_col5, #T_d3385_row11_col6, #T_d3385_row11_col7, #T_d3385_row11_col8, #T_d3385_row11_col9, #T_d3385_row11_col10, #T_d3385_row11_col11, #T_d3385_row11_col12, #T_d3385_row11_col13, #T_d3385_row11_col14, #T_d3385_row12_col0, #T_d3385_row12_col1, #T_d3385_row12_col2, #T_d3385_row12_col3, #T_d3385_row12_col4, #T_d3385_row12_col5, #T_d3385_row12_col6, #T_d3385_row12_col7, #T_d3385_row12_col8, #T_d3385_row12_col9, #T_d3385_row12_col10, #T_d3385_row12_col11, #T_d3385_row12_col12, #T_d3385_row12_col13, #T_d3385_row12_col14, #T_d3385_row13_col0, #T_d3385_row13_col1, #T_d3385_row13_col2, #T_d3385_row13_col3, #T_d3385_row13_col4, #T_d3385_row13_col5, #T_d3385_row13_col6, #T_d3385_row13_col7, #T_d3385_row13_col8, #T_d3385_row13_col9, #T_d3385_row13_col10, #T_d3385_row13_col11, #T_d3385_row13_col12, #T_d3385_row13_col13, #T_d3385_row13_col14, #T_d3385_row14_col0, #T_d3385_row14_col1, #T_d3385_row14_col3, #T_d3385_row14_col4, #T_d3385_row14_col5, #T_d3385_row14_col6, #T_d3385_row14_col7, #T_d3385_row14_col10, #T_d3385_row14_col11, #T_d3385_row14_col12, #T_d3385_row14_col14, #T_d3385_row15_col0, #T_d3385_row15_col1, #T_d3385_row15_col2, #T_d3385_row15_col3, #T_d3385_row15_col4, #T_d3385_row15_col5, #T_d3385_row15_col6, #T_d3385_row15_col7, #T_d3385_row15_col8, #T_d3385_row15_col9, #T_d3385_row15_col10, #T_d3385_row15_col11, #T_d3385_row15_col12, #T_d3385_row15_col13, #T_d3385_row15_col14 {
  background-color: #ffffd9;
  color: #000000;
}
#T_d3385_row0_col12, #T_d3385_row2_col3, #T_d3385_row5_col5, #T_d3385_row6_col6, #T_d3385_row6_col8, #T_d3385_row6_col10, #T_d3385_row6_col13, #T_d3385_row9_col0, #T_d3385_row9_col1, #T_d3385_row9_col4, #T_d3385_row9_col7, #T_d3385_row9_col9, #T_d3385_row9_col11, #T_d3385_row9_col14, #T_d3385_row14_col2 {
  background-color: #081d58;
  color: #f1f1f1;
}
#T_d3385_row6_col0, #T_d3385_row6_col4, #T_d3385_row9_col2, #T_d3385_row9_col12, #T_d3385_row14_col9 {
  background-color: #feffd6;
  color: #000000;
}
#T_d3385_row6_col9, #T_d3385_row6_col11 {
  background-color: #fdfed5;
  color: #000000;
}
#T_d3385_row9_col8 {
  background-color: #6dc6be;
  color: #000000;
}
#T_d3385_row9_col10 {
  background-color: #caeab4;
  color: #000000;
}
#T_d3385_row9_col13 {
  background-color: #e2f4b2;
  color: #000000;
}
#T_d3385_row10_col8 {
  background-color: #f6fbc5;
  color: #000000;
}
#T_d3385_row10_col13 {
  background-color: #fdfed4;
  color: #000000;
}
#T_d3385_row14_col8 {
  background-color: #a2dbb8;
  color: #000000;
}
#T_d3385_row14_col13 {
  background-color: #f9fdcb;
  color: #000000;
}
</style>
<table id="T_d3385">
  <thead>
    <tr>
      <th class="blank level0">&nbsp;</th>
      <th id="T_d3385_level0_col0" class="col_heading level0 col0">0</th>
      <th id="T_d3385_level0_col1" class="col_heading level0 col1">1</th>
      <th id="T_d3385_level0_col2" class="col_heading level0 col2">2</th>
      <th id="T_d3385_level0_col3" class="col_heading level0 col3">3</th>
      <th id="T_d3385_level0_col4" class="col_heading level0 col4">4</th>
      <th id="T_d3385_level0_col5" class="col_heading level0 col5">5</th>
      <th id="T_d3385_level0_col6" class="col_heading level0 col6">6</th>
      <th id="T_d3385_level0_col7" class="col_heading level0 col7">7</th>
      <th id="T_d3385_level0_col8" class="col_heading level0 col8">8</th>
      <th id="T_d3385_level0_col9" class="col_heading level0 col9">9</th>
      <th id="T_d3385_level0_col10" class="col_heading level0 col10">10</th>
      <th id="T_d3385_level0_col11" class="col_heading level0 col11">11</th>
      <th id="T_d3385_level0_col12" class="col_heading level0 col12">12</th>
      <th id="T_d3385_level0_col13" class="col_heading level0 col13">13</th>
      <th id="T_d3385_level0_col14" class="col_heading level0 col14">14</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_d3385_level0_row0" class="row_heading level0 row0">CC</th>
      <td id="T_d3385_row0_col0" class="data row0 col0">0.000000</td>
      <td id="T_d3385_row0_col1" class="data row0 col1">0.000000</td>
      <td id="T_d3385_row0_col2" class="data row0 col2">0.000000</td>
      <td id="T_d3385_row0_col3" class="data row0 col3">0.000000</td>
      <td id="T_d3385_row0_col4" class="data row0 col4">0.000000</td>
      <td id="T_d3385_row0_col5" class="data row0 col5">0.000000</td>
      <td id="T_d3385_row0_col6" class="data row0 col6">0.000000</td>
      <td id="T_d3385_row0_col7" class="data row0 col7">0.000000</td>
      <td id="T_d3385_row0_col8" class="data row0 col8">0.000000</td>
      <td id="T_d3385_row0_col9" class="data row0 col9">0.000000</td>
      <td id="T_d3385_row0_col10" class="data row0 col10">0.000000</td>
      <td id="T_d3385_row0_col11" class="data row0 col11">0.000000</td>
      <td id="T_d3385_row0_col12" class="data row0 col12">0.000000</td>
      <td id="T_d3385_row0_col13" class="data row0 col13">0.000000</td>
      <td id="T_d3385_row0_col14" class="data row0 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3385_level0_row1" class="row_heading level0 row1">CD</th>
      <td id="T_d3385_row1_col0" class="data row1 col0">0.000000</td>
      <td id="T_d3385_row1_col1" class="data row1 col1">0.000000</td>
      <td id="T_d3385_row1_col2" class="data row1 col2">0.000000</td>
      <td id="T_d3385_row1_col3" class="data row1 col3">0.000000</td>
      <td id="T_d3385_row1_col4" class="data row1 col4">0.000000</td>
      <td id="T_d3385_row1_col5" class="data row1 col5">0.000000</td>
      <td id="T_d3385_row1_col6" class="data row1 col6">0.000000</td>
      <td id="T_d3385_row1_col7" class="data row1 col7">0.000000</td>
      <td id="T_d3385_row1_col8" class="data row1 col8">0.000000</td>
      <td id="T_d3385_row1_col9" class="data row1 col9">0.000000</td>
      <td id="T_d3385_row1_col10" class="data row1 col10">0.000000</td>
      <td id="T_d3385_row1_col11" class="data row1 col11">0.000000</td>
      <td id="T_d3385_row1_col12" class="data row1 col12">0.000000</td>
      <td id="T_d3385_row1_col13" class="data row1 col13">0.000000</td>
      <td id="T_d3385_row1_col14" class="data row1 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3385_level0_row2" class="row_heading level0 row2">DT</th>
      <td id="T_d3385_row2_col0" class="data row2 col0">0.000000</td>
      <td id="T_d3385_row2_col1" class="data row2 col1">0.000000</td>
      <td id="T_d3385_row2_col2" class="data row2 col2">0.000000</td>
      <td id="T_d3385_row2_col3" class="data row2 col3">0.000000</td>
      <td id="T_d3385_row2_col4" class="data row2 col4">0.000000</td>
      <td id="T_d3385_row2_col5" class="data row2 col5">0.000000</td>
      <td id="T_d3385_row2_col6" class="data row2 col6">0.000000</td>
      <td id="T_d3385_row2_col7" class="data row2 col7">0.000000</td>
      <td id="T_d3385_row2_col8" class="data row2 col8">0.000000</td>
      <td id="T_d3385_row2_col9" class="data row2 col9">0.000000</td>
      <td id="T_d3385_row2_col10" class="data row2 col10">0.000000</td>
      <td id="T_d3385_row2_col11" class="data row2 col11">0.000000</td>
      <td id="T_d3385_row2_col12" class="data row2 col12">0.000000</td>
      <td id="T_d3385_row2_col13" class="data row2 col13">0.000000</td>
      <td id="T_d3385_row2_col14" class="data row2 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3385_level0_row3" class="row_heading level0 row3">EX</th>
      <td id="T_d3385_row3_col0" class="data row3 col0">0.000000</td>
      <td id="T_d3385_row3_col1" class="data row3 col1">0.000000</td>
      <td id="T_d3385_row3_col2" class="data row3 col2">0.000000</td>
      <td id="T_d3385_row3_col3" class="data row3 col3">0.000000</td>
      <td id="T_d3385_row3_col4" class="data row3 col4">0.000000</td>
      <td id="T_d3385_row3_col5" class="data row3 col5">0.000000</td>
      <td id="T_d3385_row3_col6" class="data row3 col6">0.000000</td>
      <td id="T_d3385_row3_col7" class="data row3 col7">0.000000</td>
      <td id="T_d3385_row3_col8" class="data row3 col8">0.000000</td>
      <td id="T_d3385_row3_col9" class="data row3 col9">0.000000</td>
      <td id="T_d3385_row3_col10" class="data row3 col10">0.000000</td>
      <td id="T_d3385_row3_col11" class="data row3 col11">0.000000</td>
      <td id="T_d3385_row3_col12" class="data row3 col12">0.000000</td>
      <td id="T_d3385_row3_col13" class="data row3 col13">0.000000</td>
      <td id="T_d3385_row3_col14" class="data row3 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3385_level0_row4" class="row_heading level0 row4">FW</th>
      <td id="T_d3385_row4_col0" class="data row4 col0">0.000000</td>
      <td id="T_d3385_row4_col1" class="data row4 col1">0.000000</td>
      <td id="T_d3385_row4_col2" class="data row4 col2">0.000000</td>
      <td id="T_d3385_row4_col3" class="data row4 col3">0.000000</td>
      <td id="T_d3385_row4_col4" class="data row4 col4">0.000000</td>
      <td id="T_d3385_row4_col5" class="data row4 col5">0.000000</td>
      <td id="T_d3385_row4_col6" class="data row4 col6">0.000000</td>
      <td id="T_d3385_row4_col7" class="data row4 col7">0.000000</td>
      <td id="T_d3385_row4_col8" class="data row4 col8">0.000000</td>
      <td id="T_d3385_row4_col9" class="data row4 col9">0.000000</td>
      <td id="T_d3385_row4_col10" class="data row4 col10">0.000000</td>
      <td id="T_d3385_row4_col11" class="data row4 col11">0.000000</td>
      <td id="T_d3385_row4_col12" class="data row4 col12">0.000000</td>
      <td id="T_d3385_row4_col13" class="data row4 col13">0.000000</td>
      <td id="T_d3385_row4_col14" class="data row4 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3385_level0_row5" class="row_heading level0 row5">IN</th>
      <td id="T_d3385_row5_col0" class="data row5 col0">0.000000</td>
      <td id="T_d3385_row5_col1" class="data row5 col1">0.000000</td>
      <td id="T_d3385_row5_col2" class="data row5 col2">0.000000</td>
      <td id="T_d3385_row5_col3" class="data row5 col3">0.000000</td>
      <td id="T_d3385_row5_col4" class="data row5 col4">0.000000</td>
      <td id="T_d3385_row5_col5" class="data row5 col5">0.000000</td>
      <td id="T_d3385_row5_col6" class="data row5 col6">0.000000</td>
      <td id="T_d3385_row5_col7" class="data row5 col7">0.000000</td>
      <td id="T_d3385_row5_col8" class="data row5 col8">0.000000</td>
      <td id="T_d3385_row5_col9" class="data row5 col9">0.000000</td>
      <td id="T_d3385_row5_col10" class="data row5 col10">0.000000</td>
      <td id="T_d3385_row5_col11" class="data row5 col11">0.000000</td>
      <td id="T_d3385_row5_col12" class="data row5 col12">0.000000</td>
      <td id="T_d3385_row5_col13" class="data row5 col13">0.000000</td>
      <td id="T_d3385_row5_col14" class="data row5 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3385_level0_row6" class="row_heading level0 row6">JJ</th>
      <td id="T_d3385_row6_col0" class="data row6 col0">0.000018</td>
      <td id="T_d3385_row6_col1" class="data row6 col1">0.000000</td>
      <td id="T_d3385_row6_col2" class="data row6 col2">0.000000</td>
      <td id="T_d3385_row6_col3" class="data row6 col3">0.000000</td>
      <td id="T_d3385_row6_col4" class="data row6 col4">0.000000</td>
      <td id="T_d3385_row6_col5" class="data row6 col5">0.000000</td>
      <td id="T_d3385_row6_col6" class="data row6 col6">0.000000</td>
      <td id="T_d3385_row6_col7" class="data row6 col7">0.000000</td>
      <td id="T_d3385_row6_col8" class="data row6 col8">0.000000</td>
      <td id="T_d3385_row6_col9" class="data row6 col9">0.000000</td>
      <td id="T_d3385_row6_col10" class="data row6 col10">0.000000</td>
      <td id="T_d3385_row6_col11" class="data row6 col11">0.000000</td>
      <td id="T_d3385_row6_col12" class="data row6 col12">0.000000</td>
      <td id="T_d3385_row6_col13" class="data row6 col13">0.000000</td>
      <td id="T_d3385_row6_col14" class="data row6 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3385_level0_row7" class="row_heading level0 row7">LS</th>
      <td id="T_d3385_row7_col0" class="data row7 col0">0.000000</td>
      <td id="T_d3385_row7_col1" class="data row7 col1">0.000000</td>
      <td id="T_d3385_row7_col2" class="data row7 col2">0.000000</td>
      <td id="T_d3385_row7_col3" class="data row7 col3">0.000000</td>
      <td id="T_d3385_row7_col4" class="data row7 col4">0.000000</td>
      <td id="T_d3385_row7_col5" class="data row7 col5">0.000000</td>
      <td id="T_d3385_row7_col6" class="data row7 col6">0.000000</td>
      <td id="T_d3385_row7_col7" class="data row7 col7">0.000000</td>
      <td id="T_d3385_row7_col8" class="data row7 col8">0.000000</td>
      <td id="T_d3385_row7_col9" class="data row7 col9">0.000000</td>
      <td id="T_d3385_row7_col10" class="data row7 col10">0.000000</td>
      <td id="T_d3385_row7_col11" class="data row7 col11">0.000000</td>
      <td id="T_d3385_row7_col12" class="data row7 col12">0.000000</td>
      <td id="T_d3385_row7_col13" class="data row7 col13">0.000000</td>
      <td id="T_d3385_row7_col14" class="data row7 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3385_level0_row8" class="row_heading level0 row8">MD</th>
      <td id="T_d3385_row8_col0" class="data row8 col0">0.000000</td>
      <td id="T_d3385_row8_col1" class="data row8 col1">0.000000</td>
      <td id="T_d3385_row8_col2" class="data row8 col2">0.000000</td>
      <td id="T_d3385_row8_col3" class="data row8 col3">0.000000</td>
      <td id="T_d3385_row8_col4" class="data row8 col4">0.000000</td>
      <td id="T_d3385_row8_col5" class="data row8 col5">0.000000</td>
      <td id="T_d3385_row8_col6" class="data row8 col6">0.000000</td>
      <td id="T_d3385_row8_col7" class="data row8 col7">0.000000</td>
      <td id="T_d3385_row8_col8" class="data row8 col8">0.000000</td>
      <td id="T_d3385_row8_col9" class="data row8 col9">0.000000</td>
      <td id="T_d3385_row8_col10" class="data row8 col10">0.000000</td>
      <td id="T_d3385_row8_col11" class="data row8 col11">0.000000</td>
      <td id="T_d3385_row8_col12" class="data row8 col12">0.000000</td>
      <td id="T_d3385_row8_col13" class="data row8 col13">0.000000</td>
      <td id="T_d3385_row8_col14" class="data row8 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3385_level0_row9" class="row_heading level0 row9">NN</th>
      <td id="T_d3385_row9_col0" class="data row9 col0">0.002150</td>
      <td id="T_d3385_row9_col1" class="data row9 col1">0.000000</td>
      <td id="T_d3385_row9_col2" class="data row9 col2">0.000000</td>
      <td id="T_d3385_row9_col3" class="data row9 col3">0.000000</td>
      <td id="T_d3385_row9_col4" class="data row9 col4">0.000000</td>
      <td id="T_d3385_row9_col5" class="data row9 col5">0.000000</td>
      <td id="T_d3385_row9_col6" class="data row9 col6">0.000000</td>
      <td id="T_d3385_row9_col7" class="data row9 col7">0.000000</td>
      <td id="T_d3385_row9_col8" class="data row9 col8">0.000000</td>
      <td id="T_d3385_row9_col9" class="data row9 col9">0.000000</td>
      <td id="T_d3385_row9_col10" class="data row9 col10">0.000000</td>
      <td id="T_d3385_row9_col11" class="data row9 col11">0.000000</td>
      <td id="T_d3385_row9_col12" class="data row9 col12">0.000000</td>
      <td id="T_d3385_row9_col13" class="data row9 col13">0.000000</td>
      <td id="T_d3385_row9_col14" class="data row9 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3385_level0_row10" class="row_heading level0 row10">RB</th>
      <td id="T_d3385_row10_col0" class="data row10 col0">0.000002</td>
      <td id="T_d3385_row10_col1" class="data row10 col1">0.000000</td>
      <td id="T_d3385_row10_col2" class="data row10 col2">0.000000</td>
      <td id="T_d3385_row10_col3" class="data row10 col3">0.000000</td>
      <td id="T_d3385_row10_col4" class="data row10 col4">0.000000</td>
      <td id="T_d3385_row10_col5" class="data row10 col5">0.000000</td>
      <td id="T_d3385_row10_col6" class="data row10 col6">0.000000</td>
      <td id="T_d3385_row10_col7" class="data row10 col7">0.000000</td>
      <td id="T_d3385_row10_col8" class="data row10 col8">0.000000</td>
      <td id="T_d3385_row10_col9" class="data row10 col9">0.000000</td>
      <td id="T_d3385_row10_col10" class="data row10 col10">0.000000</td>
      <td id="T_d3385_row10_col11" class="data row10 col11">0.000000</td>
      <td id="T_d3385_row10_col12" class="data row10 col12">0.000000</td>
      <td id="T_d3385_row10_col13" class="data row10 col13">0.000000</td>
      <td id="T_d3385_row10_col14" class="data row10 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3385_level0_row11" class="row_heading level0 row11">RP</th>
      <td id="T_d3385_row11_col0" class="data row11 col0">0.000000</td>
      <td id="T_d3385_row11_col1" class="data row11 col1">0.000000</td>
      <td id="T_d3385_row11_col2" class="data row11 col2">0.000000</td>
      <td id="T_d3385_row11_col3" class="data row11 col3">0.000000</td>
      <td id="T_d3385_row11_col4" class="data row11 col4">0.000000</td>
      <td id="T_d3385_row11_col5" class="data row11 col5">0.000000</td>
      <td id="T_d3385_row11_col6" class="data row11 col6">0.000000</td>
      <td id="T_d3385_row11_col7" class="data row11 col7">0.000000</td>
      <td id="T_d3385_row11_col8" class="data row11 col8">0.000000</td>
      <td id="T_d3385_row11_col9" class="data row11 col9">0.000000</td>
      <td id="T_d3385_row11_col10" class="data row11 col10">0.000000</td>
      <td id="T_d3385_row11_col11" class="data row11 col11">0.000000</td>
      <td id="T_d3385_row11_col12" class="data row11 col12">0.000000</td>
      <td id="T_d3385_row11_col13" class="data row11 col13">0.000000</td>
      <td id="T_d3385_row11_col14" class="data row11 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3385_level0_row12" class="row_heading level0 row12">TO</th>
      <td id="T_d3385_row12_col0" class="data row12 col0">0.000000</td>
      <td id="T_d3385_row12_col1" class="data row12 col1">0.000000</td>
      <td id="T_d3385_row12_col2" class="data row12 col2">0.000000</td>
      <td id="T_d3385_row12_col3" class="data row12 col3">0.000000</td>
      <td id="T_d3385_row12_col4" class="data row12 col4">0.000000</td>
      <td id="T_d3385_row12_col5" class="data row12 col5">0.000000</td>
      <td id="T_d3385_row12_col6" class="data row12 col6">0.000000</td>
      <td id="T_d3385_row12_col7" class="data row12 col7">0.000000</td>
      <td id="T_d3385_row12_col8" class="data row12 col8">0.000000</td>
      <td id="T_d3385_row12_col9" class="data row12 col9">0.000000</td>
      <td id="T_d3385_row12_col10" class="data row12 col10">0.000000</td>
      <td id="T_d3385_row12_col11" class="data row12 col11">0.000000</td>
      <td id="T_d3385_row12_col12" class="data row12 col12">0.000000</td>
      <td id="T_d3385_row12_col13" class="data row12 col13">0.000000</td>
      <td id="T_d3385_row12_col14" class="data row12 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3385_level0_row13" class="row_heading level0 row13">UH</th>
      <td id="T_d3385_row13_col0" class="data row13 col0">0.000000</td>
      <td id="T_d3385_row13_col1" class="data row13 col1">0.000000</td>
      <td id="T_d3385_row13_col2" class="data row13 col2">0.000000</td>
      <td id="T_d3385_row13_col3" class="data row13 col3">0.000000</td>
      <td id="T_d3385_row13_col4" class="data row13 col4">0.000000</td>
      <td id="T_d3385_row13_col5" class="data row13 col5">0.000000</td>
      <td id="T_d3385_row13_col6" class="data row13 col6">0.000000</td>
      <td id="T_d3385_row13_col7" class="data row13 col7">0.000000</td>
      <td id="T_d3385_row13_col8" class="data row13 col8">0.000000</td>
      <td id="T_d3385_row13_col9" class="data row13 col9">0.000000</td>
      <td id="T_d3385_row13_col10" class="data row13 col10">0.000000</td>
      <td id="T_d3385_row13_col11" class="data row13 col11">0.000000</td>
      <td id="T_d3385_row13_col12" class="data row13 col12">0.000000</td>
      <td id="T_d3385_row13_col13" class="data row13 col13">0.000000</td>
      <td id="T_d3385_row13_col14" class="data row13 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3385_level0_row14" class="row_heading level0 row14">VB</th>
      <td id="T_d3385_row14_col0" class="data row14 col0">0.000000</td>
      <td id="T_d3385_row14_col1" class="data row14 col1">0.000000</td>
      <td id="T_d3385_row14_col2" class="data row14 col2">0.000000</td>
      <td id="T_d3385_row14_col3" class="data row14 col3">0.000000</td>
      <td id="T_d3385_row14_col4" class="data row14 col4">0.000000</td>
      <td id="T_d3385_row14_col5" class="data row14 col5">0.000000</td>
      <td id="T_d3385_row14_col6" class="data row14 col6">0.000000</td>
      <td id="T_d3385_row14_col7" class="data row14 col7">0.000000</td>
      <td id="T_d3385_row14_col8" class="data row14 col8">0.000000</td>
      <td id="T_d3385_row14_col9" class="data row14 col9">0.000000</td>
      <td id="T_d3385_row14_col10" class="data row14 col10">0.000000</td>
      <td id="T_d3385_row14_col11" class="data row14 col11">0.000000</td>
      <td id="T_d3385_row14_col12" class="data row14 col12">0.000000</td>
      <td id="T_d3385_row14_col13" class="data row14 col13">0.000000</td>
      <td id="T_d3385_row14_col14" class="data row14 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_d3385_level0_row15" class="row_heading level0 row15">WP</th>
      <td id="T_d3385_row15_col0" class="data row15 col0">0.000000</td>
      <td id="T_d3385_row15_col1" class="data row15 col1">0.000000</td>
      <td id="T_d3385_row15_col2" class="data row15 col2">0.000000</td>
      <td id="T_d3385_row15_col3" class="data row15 col3">0.000000</td>
      <td id="T_d3385_row15_col4" class="data row15 col4">0.000000</td>
      <td id="T_d3385_row15_col5" class="data row15 col5">0.000000</td>
      <td id="T_d3385_row15_col6" class="data row15 col6">0.000000</td>
      <td id="T_d3385_row15_col7" class="data row15 col7">0.000000</td>
      <td id="T_d3385_row15_col8" class="data row15 col8">0.000000</td>
      <td id="T_d3385_row15_col9" class="data row15 col9">0.000000</td>
      <td id="T_d3385_row15_col10" class="data row15 col10">0.000000</td>
      <td id="T_d3385_row15_col11" class="data row15 col11">0.000000</td>
      <td id="T_d3385_row15_col12" class="data row15 col12">0.000000</td>
      <td id="T_d3385_row15_col13" class="data row15 col13">0.000000</td>
      <td id="T_d3385_row15_col14" class="data row15 col14">0.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>Try L1 normalization by column.</p>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>VNORM <span class="op">=</span> (V <span class="op">/</span> V.<span class="bu">sum</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>VNORM.<span class="bu">max</span>().plot.bar(rot<span class="op">=</span><span class="dv">0</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="M04_02_HMM_files/figure-html/cell-48-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>VNORM.style.background_gradient(cmap<span class="op">=</span>colors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">

<style type="text/css">
#T_3dfed_row0_col0, #T_3dfed_row0_col1, #T_3dfed_row0_col2, #T_3dfed_row0_col3, #T_3dfed_row0_col4, #T_3dfed_row0_col5, #T_3dfed_row0_col6, #T_3dfed_row0_col7, #T_3dfed_row0_col8, #T_3dfed_row0_col9, #T_3dfed_row0_col10, #T_3dfed_row0_col11, #T_3dfed_row0_col13, #T_3dfed_row0_col14, #T_3dfed_row1_col0, #T_3dfed_row1_col1, #T_3dfed_row1_col2, #T_3dfed_row1_col3, #T_3dfed_row1_col4, #T_3dfed_row1_col5, #T_3dfed_row1_col6, #T_3dfed_row1_col7, #T_3dfed_row1_col8, #T_3dfed_row1_col9, #T_3dfed_row1_col10, #T_3dfed_row1_col11, #T_3dfed_row1_col12, #T_3dfed_row1_col13, #T_3dfed_row1_col14, #T_3dfed_row2_col0, #T_3dfed_row2_col1, #T_3dfed_row2_col2, #T_3dfed_row2_col4, #T_3dfed_row2_col5, #T_3dfed_row2_col6, #T_3dfed_row2_col7, #T_3dfed_row2_col8, #T_3dfed_row2_col9, #T_3dfed_row2_col10, #T_3dfed_row2_col11, #T_3dfed_row2_col12, #T_3dfed_row2_col13, #T_3dfed_row2_col14, #T_3dfed_row3_col0, #T_3dfed_row3_col1, #T_3dfed_row3_col2, #T_3dfed_row3_col3, #T_3dfed_row3_col4, #T_3dfed_row3_col5, #T_3dfed_row3_col6, #T_3dfed_row3_col7, #T_3dfed_row3_col8, #T_3dfed_row3_col9, #T_3dfed_row3_col10, #T_3dfed_row3_col11, #T_3dfed_row3_col12, #T_3dfed_row3_col13, #T_3dfed_row3_col14, #T_3dfed_row4_col0, #T_3dfed_row4_col1, #T_3dfed_row4_col2, #T_3dfed_row4_col3, #T_3dfed_row4_col4, #T_3dfed_row4_col5, #T_3dfed_row4_col6, #T_3dfed_row4_col7, #T_3dfed_row4_col8, #T_3dfed_row4_col9, #T_3dfed_row4_col10, #T_3dfed_row4_col11, #T_3dfed_row4_col12, #T_3dfed_row4_col13, #T_3dfed_row4_col14, #T_3dfed_row5_col0, #T_3dfed_row5_col1, #T_3dfed_row5_col2, #T_3dfed_row5_col3, #T_3dfed_row5_col4, #T_3dfed_row5_col6, #T_3dfed_row5_col7, #T_3dfed_row5_col8, #T_3dfed_row5_col9, #T_3dfed_row5_col10, #T_3dfed_row5_col11, #T_3dfed_row5_col12, #T_3dfed_row5_col13, #T_3dfed_row5_col14, #T_3dfed_row6_col1, #T_3dfed_row6_col2, #T_3dfed_row6_col3, #T_3dfed_row6_col5, #T_3dfed_row6_col7, #T_3dfed_row6_col12, #T_3dfed_row6_col14, #T_3dfed_row7_col0, #T_3dfed_row7_col1, #T_3dfed_row7_col2, #T_3dfed_row7_col3, #T_3dfed_row7_col4, #T_3dfed_row7_col5, #T_3dfed_row7_col6, #T_3dfed_row7_col7, #T_3dfed_row7_col8, #T_3dfed_row7_col9, #T_3dfed_row7_col10, #T_3dfed_row7_col11, #T_3dfed_row7_col12, #T_3dfed_row7_col13, #T_3dfed_row7_col14, #T_3dfed_row8_col0, #T_3dfed_row8_col1, #T_3dfed_row8_col2, #T_3dfed_row8_col3, #T_3dfed_row8_col4, #T_3dfed_row8_col5, #T_3dfed_row8_col6, #T_3dfed_row8_col7, #T_3dfed_row8_col8, #T_3dfed_row8_col9, #T_3dfed_row8_col10, #T_3dfed_row8_col11, #T_3dfed_row8_col12, #T_3dfed_row8_col13, #T_3dfed_row8_col14, #T_3dfed_row9_col3, #T_3dfed_row9_col5, #T_3dfed_row9_col6, #T_3dfed_row10_col0, #T_3dfed_row10_col1, #T_3dfed_row10_col2, #T_3dfed_row10_col3, #T_3dfed_row10_col4, #T_3dfed_row10_col5, #T_3dfed_row10_col6, #T_3dfed_row10_col7, #T_3dfed_row10_col9, #T_3dfed_row10_col10, #T_3dfed_row10_col11, #T_3dfed_row10_col12, #T_3dfed_row10_col14, #T_3dfed_row11_col0, #T_3dfed_row11_col1, #T_3dfed_row11_col2, #T_3dfed_row11_col3, #T_3dfed_row11_col4, #T_3dfed_row11_col5, #T_3dfed_row11_col6, #T_3dfed_row11_col7, #T_3dfed_row11_col8, #T_3dfed_row11_col9, #T_3dfed_row11_col10, #T_3dfed_row11_col11, #T_3dfed_row11_col12, #T_3dfed_row11_col13, #T_3dfed_row11_col14, #T_3dfed_row12_col0, #T_3dfed_row12_col1, #T_3dfed_row12_col2, #T_3dfed_row12_col3, #T_3dfed_row12_col4, #T_3dfed_row12_col5, #T_3dfed_row12_col6, #T_3dfed_row12_col7, #T_3dfed_row12_col8, #T_3dfed_row12_col9, #T_3dfed_row12_col10, #T_3dfed_row12_col11, #T_3dfed_row12_col12, #T_3dfed_row12_col13, #T_3dfed_row12_col14, #T_3dfed_row13_col0, #T_3dfed_row13_col1, #T_3dfed_row13_col2, #T_3dfed_row13_col3, #T_3dfed_row13_col4, #T_3dfed_row13_col5, #T_3dfed_row13_col6, #T_3dfed_row13_col7, #T_3dfed_row13_col8, #T_3dfed_row13_col9, #T_3dfed_row13_col10, #T_3dfed_row13_col11, #T_3dfed_row13_col12, #T_3dfed_row13_col13, #T_3dfed_row13_col14, #T_3dfed_row14_col0, #T_3dfed_row14_col1, #T_3dfed_row14_col3, #T_3dfed_row14_col4, #T_3dfed_row14_col5, #T_3dfed_row14_col6, #T_3dfed_row14_col7, #T_3dfed_row14_col10, #T_3dfed_row14_col11, #T_3dfed_row14_col12, #T_3dfed_row14_col14, #T_3dfed_row15_col0, #T_3dfed_row15_col1, #T_3dfed_row15_col2, #T_3dfed_row15_col3, #T_3dfed_row15_col4, #T_3dfed_row15_col5, #T_3dfed_row15_col6, #T_3dfed_row15_col7, #T_3dfed_row15_col8, #T_3dfed_row15_col9, #T_3dfed_row15_col10, #T_3dfed_row15_col11, #T_3dfed_row15_col12, #T_3dfed_row15_col13, #T_3dfed_row15_col14 {
  background-color: #ffffd9;
  color: #000000;
}
#T_3dfed_row0_col12, #T_3dfed_row2_col3, #T_3dfed_row5_col5, #T_3dfed_row6_col6, #T_3dfed_row6_col8, #T_3dfed_row6_col10, #T_3dfed_row6_col13, #T_3dfed_row9_col0, #T_3dfed_row9_col1, #T_3dfed_row9_col4, #T_3dfed_row9_col7, #T_3dfed_row9_col9, #T_3dfed_row9_col11, #T_3dfed_row9_col14, #T_3dfed_row14_col2 {
  background-color: #081d58;
  color: #f1f1f1;
}
#T_3dfed_row6_col0, #T_3dfed_row6_col4, #T_3dfed_row9_col2, #T_3dfed_row9_col12, #T_3dfed_row14_col9 {
  background-color: #feffd6;
  color: #000000;
}
#T_3dfed_row6_col9, #T_3dfed_row6_col11 {
  background-color: #fdfed5;
  color: #000000;
}
#T_3dfed_row9_col8 {
  background-color: #6dc6be;
  color: #000000;
}
#T_3dfed_row9_col10 {
  background-color: #caeab4;
  color: #000000;
}
#T_3dfed_row9_col13 {
  background-color: #e2f4b2;
  color: #000000;
}
#T_3dfed_row10_col8 {
  background-color: #f6fbc5;
  color: #000000;
}
#T_3dfed_row10_col13 {
  background-color: #fdfed4;
  color: #000000;
}
#T_3dfed_row14_col8 {
  background-color: #a2dbb8;
  color: #000000;
}
#T_3dfed_row14_col13 {
  background-color: #f9fdcb;
  color: #000000;
}
</style>
<table id="T_3dfed">
  <thead>
    <tr>
      <th class="blank level0">&nbsp;</th>
      <th id="T_3dfed_level0_col0" class="col_heading level0 col0">0</th>
      <th id="T_3dfed_level0_col1" class="col_heading level0 col1">1</th>
      <th id="T_3dfed_level0_col2" class="col_heading level0 col2">2</th>
      <th id="T_3dfed_level0_col3" class="col_heading level0 col3">3</th>
      <th id="T_3dfed_level0_col4" class="col_heading level0 col4">4</th>
      <th id="T_3dfed_level0_col5" class="col_heading level0 col5">5</th>
      <th id="T_3dfed_level0_col6" class="col_heading level0 col6">6</th>
      <th id="T_3dfed_level0_col7" class="col_heading level0 col7">7</th>
      <th id="T_3dfed_level0_col8" class="col_heading level0 col8">8</th>
      <th id="T_3dfed_level0_col9" class="col_heading level0 col9">9</th>
      <th id="T_3dfed_level0_col10" class="col_heading level0 col10">10</th>
      <th id="T_3dfed_level0_col11" class="col_heading level0 col11">11</th>
      <th id="T_3dfed_level0_col12" class="col_heading level0 col12">12</th>
      <th id="T_3dfed_level0_col13" class="col_heading level0 col13">13</th>
      <th id="T_3dfed_level0_col14" class="col_heading level0 col14">14</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_3dfed_level0_row0" class="row_heading level0 row0">CC</th>
      <td id="T_3dfed_row0_col0" class="data row0 col0">0.000000</td>
      <td id="T_3dfed_row0_col1" class="data row0 col1">0.000000</td>
      <td id="T_3dfed_row0_col2" class="data row0 col2">0.000090</td>
      <td id="T_3dfed_row0_col3" class="data row0 col3">0.000000</td>
      <td id="T_3dfed_row0_col4" class="data row0 col4">0.000000</td>
      <td id="T_3dfed_row0_col5" class="data row0 col5">0.000000</td>
      <td id="T_3dfed_row0_col6" class="data row0 col6">0.000000</td>
      <td id="T_3dfed_row0_col7" class="data row0 col7">0.000000</td>
      <td id="T_3dfed_row0_col8" class="data row0 col8">0.000000</td>
      <td id="T_3dfed_row0_col9" class="data row0 col9">0.000000</td>
      <td id="T_3dfed_row0_col10" class="data row0 col10">0.000000</td>
      <td id="T_3dfed_row0_col11" class="data row0 col11">0.000000</td>
      <td id="T_3dfed_row0_col12" class="data row0 col12">0.988700</td>
      <td id="T_3dfed_row0_col13" class="data row0 col13">0.000000</td>
      <td id="T_3dfed_row0_col14" class="data row0 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_3dfed_level0_row1" class="row_heading level0 row1">CD</th>
      <td id="T_3dfed_row1_col0" class="data row1 col0">0.000000</td>
      <td id="T_3dfed_row1_col1" class="data row1 col1">0.000000</td>
      <td id="T_3dfed_row1_col2" class="data row1 col2">0.000000</td>
      <td id="T_3dfed_row1_col3" class="data row1 col3">0.000048</td>
      <td id="T_3dfed_row1_col4" class="data row1 col4">0.000165</td>
      <td id="T_3dfed_row1_col5" class="data row1 col5">0.000000</td>
      <td id="T_3dfed_row1_col6" class="data row1 col6">0.000000</td>
      <td id="T_3dfed_row1_col7" class="data row1 col7">0.000000</td>
      <td id="T_3dfed_row1_col8" class="data row1 col8">0.000000</td>
      <td id="T_3dfed_row1_col9" class="data row1 col9">0.000000</td>
      <td id="T_3dfed_row1_col10" class="data row1 col10">0.000000</td>
      <td id="T_3dfed_row1_col11" class="data row1 col11">0.000000</td>
      <td id="T_3dfed_row1_col12" class="data row1 col12">0.000012</td>
      <td id="T_3dfed_row1_col13" class="data row1 col13">0.000000</td>
      <td id="T_3dfed_row1_col14" class="data row1 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_3dfed_level0_row2" class="row_heading level0 row2">DT</th>
      <td id="T_3dfed_row2_col0" class="data row2 col0">0.000000</td>
      <td id="T_3dfed_row2_col1" class="data row2 col1">0.000000</td>
      <td id="T_3dfed_row2_col2" class="data row2 col2">0.000000</td>
      <td id="T_3dfed_row2_col3" class="data row2 col3">0.993741</td>
      <td id="T_3dfed_row2_col4" class="data row2 col4">0.000000</td>
      <td id="T_3dfed_row2_col5" class="data row2 col5">0.000000</td>
      <td id="T_3dfed_row2_col6" class="data row2 col6">0.000000</td>
      <td id="T_3dfed_row2_col7" class="data row2 col7">0.000000</td>
      <td id="T_3dfed_row2_col8" class="data row2 col8">0.000000</td>
      <td id="T_3dfed_row2_col9" class="data row2 col9">0.000000</td>
      <td id="T_3dfed_row2_col10" class="data row2 col10">0.000000</td>
      <td id="T_3dfed_row2_col11" class="data row2 col11">0.000000</td>
      <td id="T_3dfed_row2_col12" class="data row2 col12">0.000000</td>
      <td id="T_3dfed_row2_col13" class="data row2 col13">0.000000</td>
      <td id="T_3dfed_row2_col14" class="data row2 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_3dfed_level0_row3" class="row_heading level0 row3">EX</th>
      <td id="T_3dfed_row3_col0" class="data row3 col0">0.000000</td>
      <td id="T_3dfed_row3_col1" class="data row3 col1">0.000000</td>
      <td id="T_3dfed_row3_col2" class="data row3 col2">0.000000</td>
      <td id="T_3dfed_row3_col3" class="data row3 col3">0.000000</td>
      <td id="T_3dfed_row3_col4" class="data row3 col4">0.000000</td>
      <td id="T_3dfed_row3_col5" class="data row3 col5">0.000000</td>
      <td id="T_3dfed_row3_col6" class="data row3 col6">0.000000</td>
      <td id="T_3dfed_row3_col7" class="data row3 col7">0.000000</td>
      <td id="T_3dfed_row3_col8" class="data row3 col8">0.000000</td>
      <td id="T_3dfed_row3_col9" class="data row3 col9">0.000000</td>
      <td id="T_3dfed_row3_col10" class="data row3 col10">0.000000</td>
      <td id="T_3dfed_row3_col11" class="data row3 col11">0.000000</td>
      <td id="T_3dfed_row3_col12" class="data row3 col12">0.000000</td>
      <td id="T_3dfed_row3_col13" class="data row3 col13">0.000000</td>
      <td id="T_3dfed_row3_col14" class="data row3 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_3dfed_level0_row4" class="row_heading level0 row4">FW</th>
      <td id="T_3dfed_row4_col0" class="data row4 col0">0.000000</td>
      <td id="T_3dfed_row4_col1" class="data row4 col1">0.000000</td>
      <td id="T_3dfed_row4_col2" class="data row4 col2">0.000000</td>
      <td id="T_3dfed_row4_col3" class="data row4 col3">0.000000</td>
      <td id="T_3dfed_row4_col4" class="data row4 col4">0.000405</td>
      <td id="T_3dfed_row4_col5" class="data row4 col5">0.000000</td>
      <td id="T_3dfed_row4_col6" class="data row4 col6">0.000000</td>
      <td id="T_3dfed_row4_col7" class="data row4 col7">0.000000</td>
      <td id="T_3dfed_row4_col8" class="data row4 col8">0.000000</td>
      <td id="T_3dfed_row4_col9" class="data row4 col9">0.000000</td>
      <td id="T_3dfed_row4_col10" class="data row4 col10">0.000000</td>
      <td id="T_3dfed_row4_col11" class="data row4 col11">0.000000</td>
      <td id="T_3dfed_row4_col12" class="data row4 col12">0.000000</td>
      <td id="T_3dfed_row4_col13" class="data row4 col13">0.000000</td>
      <td id="T_3dfed_row4_col14" class="data row4 col14">0.002511</td>
    </tr>
    <tr>
      <th id="T_3dfed_level0_row5" class="row_heading level0 row5">IN</th>
      <td id="T_3dfed_row5_col0" class="data row5 col0">0.000000</td>
      <td id="T_3dfed_row5_col1" class="data row5 col1">0.000000</td>
      <td id="T_3dfed_row5_col2" class="data row5 col2">0.001614</td>
      <td id="T_3dfed_row5_col3" class="data row5 col3">0.000022</td>
      <td id="T_3dfed_row5_col4" class="data row5 col4">0.000022</td>
      <td id="T_3dfed_row5_col5" class="data row5 col5">0.996264</td>
      <td id="T_3dfed_row5_col6" class="data row5 col6">0.000000</td>
      <td id="T_3dfed_row5_col7" class="data row5 col7">0.000000</td>
      <td id="T_3dfed_row5_col8" class="data row5 col8">0.000000</td>
      <td id="T_3dfed_row5_col9" class="data row5 col9">0.000000</td>
      <td id="T_3dfed_row5_col10" class="data row5 col10">0.000000</td>
      <td id="T_3dfed_row5_col11" class="data row5 col11">0.001986</td>
      <td id="T_3dfed_row5_col12" class="data row5 col12">0.000899</td>
      <td id="T_3dfed_row5_col13" class="data row5 col13">0.000000</td>
      <td id="T_3dfed_row5_col14" class="data row5 col14">0.001069</td>
    </tr>
    <tr>
      <th id="T_3dfed_level0_row6" class="row_heading level0 row6">JJ</th>
      <td id="T_3dfed_row6_col0" class="data row6 col0">0.008322</td>
      <td id="T_3dfed_row6_col1" class="data row6 col1">0.000000</td>
      <td id="T_3dfed_row6_col2" class="data row6 col2">0.000251</td>
      <td id="T_3dfed_row6_col3" class="data row6 col3">0.002262</td>
      <td id="T_3dfed_row6_col4" class="data row6 col4">0.008383</td>
      <td id="T_3dfed_row6_col5" class="data row6 col5">0.000132</td>
      <td id="T_3dfed_row6_col6" class="data row6 col6">1.000000</td>
      <td id="T_3dfed_row6_col7" class="data row6 col7">0.000749</td>
      <td id="T_3dfed_row6_col8" class="data row6 col8">0.557584</td>
      <td id="T_3dfed_row6_col9" class="data row6 col9">0.014583</td>
      <td id="T_3dfed_row6_col10" class="data row6 col10">0.805422</td>
      <td id="T_3dfed_row6_col11" class="data row6 col11">0.012132</td>
      <td id="T_3dfed_row6_col12" class="data row6 col12">0.000220</td>
      <td id="T_3dfed_row6_col13" class="data row6 col13">0.816619</td>
      <td id="T_3dfed_row6_col14" class="data row6 col14">0.002611</td>
    </tr>
    <tr>
      <th id="T_3dfed_level0_row7" class="row_heading level0 row7">LS</th>
      <td id="T_3dfed_row7_col0" class="data row7 col0">0.000000</td>
      <td id="T_3dfed_row7_col1" class="data row7 col1">0.000000</td>
      <td id="T_3dfed_row7_col2" class="data row7 col2">0.000000</td>
      <td id="T_3dfed_row7_col3" class="data row7 col3">0.000000</td>
      <td id="T_3dfed_row7_col4" class="data row7 col4">0.000000</td>
      <td id="T_3dfed_row7_col5" class="data row7 col5">0.000000</td>
      <td id="T_3dfed_row7_col6" class="data row7 col6">0.000000</td>
      <td id="T_3dfed_row7_col7" class="data row7 col7">0.000000</td>
      <td id="T_3dfed_row7_col8" class="data row7 col8">0.000000</td>
      <td id="T_3dfed_row7_col9" class="data row7 col9">0.000000</td>
      <td id="T_3dfed_row7_col10" class="data row7 col10">0.000000</td>
      <td id="T_3dfed_row7_col11" class="data row7 col11">0.000000</td>
      <td id="T_3dfed_row7_col12" class="data row7 col12">0.000022</td>
      <td id="T_3dfed_row7_col13" class="data row7 col13">0.000000</td>
      <td id="T_3dfed_row7_col14" class="data row7 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_3dfed_level0_row8" class="row_heading level0 row8">MD</th>
      <td id="T_3dfed_row8_col0" class="data row8 col0">0.000000</td>
      <td id="T_3dfed_row8_col1" class="data row8 col1">0.000000</td>
      <td id="T_3dfed_row8_col2" class="data row8 col2">0.000686</td>
      <td id="T_3dfed_row8_col3" class="data row8 col3">0.000000</td>
      <td id="T_3dfed_row8_col4" class="data row8 col4">0.000018</td>
      <td id="T_3dfed_row8_col5" class="data row8 col5">0.000033</td>
      <td id="T_3dfed_row8_col6" class="data row8 col6">0.000000</td>
      <td id="T_3dfed_row8_col7" class="data row8 col7">0.000000</td>
      <td id="T_3dfed_row8_col8" class="data row8 col8">0.000000</td>
      <td id="T_3dfed_row8_col9" class="data row8 col9">0.000000</td>
      <td id="T_3dfed_row8_col10" class="data row8 col10">0.000000</td>
      <td id="T_3dfed_row8_col11" class="data row8 col11">0.000000</td>
      <td id="T_3dfed_row8_col12" class="data row8 col12">0.000025</td>
      <td id="T_3dfed_row8_col13" class="data row8 col13">0.000000</td>
      <td id="T_3dfed_row8_col14" class="data row8 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_3dfed_level0_row9" class="row_heading level0 row9">NN</th>
      <td id="T_3dfed_row9_col0" class="data row9 col0">0.990721</td>
      <td id="T_3dfed_row9_col1" class="data row9 col1">1.000000</td>
      <td id="T_3dfed_row9_col2" class="data row9 col2">0.007791</td>
      <td id="T_3dfed_row9_col3" class="data row9 col3">0.002941</td>
      <td id="T_3dfed_row9_col4" class="data row9 col4">0.989633</td>
      <td id="T_3dfed_row9_col5" class="data row9 col5">0.002906</td>
      <td id="T_3dfed_row9_col6" class="data row9 col6">0.000000</td>
      <td id="T_3dfed_row9_col7" class="data row9 col7">0.997763</td>
      <td id="T_3dfed_row9_col8" class="data row9 col8">0.230737</td>
      <td id="T_3dfed_row9_col9" class="data row9 col9">0.974166</td>
      <td id="T_3dfed_row9_col10" class="data row9 col10">0.194578</td>
      <td id="T_3dfed_row9_col11" class="data row9 col11">0.984918</td>
      <td id="T_3dfed_row9_col12" class="data row9 col12">0.008344</td>
      <td id="T_3dfed_row9_col13" class="data row9 col13">0.132670</td>
      <td id="T_3dfed_row9_col14" class="data row9 col14">0.991695</td>
    </tr>
    <tr>
      <th id="T_3dfed_level0_row10" class="row_heading level0 row10">RB</th>
      <td id="T_3dfed_row10_col0" class="data row10 col0">0.000845</td>
      <td id="T_3dfed_row10_col1" class="data row10 col1">0.000000</td>
      <td id="T_3dfed_row10_col2" class="data row10 col2">0.000111</td>
      <td id="T_3dfed_row10_col3" class="data row10 col3">0.000883</td>
      <td id="T_3dfed_row10_col4" class="data row10 col4">0.000104</td>
      <td id="T_3dfed_row10_col5" class="data row10 col5">0.000270</td>
      <td id="T_3dfed_row10_col6" class="data row10 col6">0.000000</td>
      <td id="T_3dfed_row10_col7" class="data row10 col7">0.000000</td>
      <td id="T_3dfed_row10_col8" class="data row10 col8">0.036579</td>
      <td id="T_3dfed_row10_col9" class="data row10 col9">0.000000</td>
      <td id="T_3dfed_row10_col10" class="data row10 col10">0.000000</td>
      <td id="T_3dfed_row10_col11" class="data row10 col11">0.000000</td>
      <td id="T_3dfed_row10_col12" class="data row10 col12">0.000511</td>
      <td id="T_3dfed_row10_col13" class="data row10 col13">0.015077</td>
      <td id="T_3dfed_row10_col14" class="data row10 col14">0.000557</td>
    </tr>
    <tr>
      <th id="T_3dfed_level0_row11" class="row_heading level0 row11">RP</th>
      <td id="T_3dfed_row11_col0" class="data row11 col0">0.000000</td>
      <td id="T_3dfed_row11_col1" class="data row11 col1">0.000000</td>
      <td id="T_3dfed_row11_col2" class="data row11 col2">0.000000</td>
      <td id="T_3dfed_row11_col3" class="data row11 col3">0.000000</td>
      <td id="T_3dfed_row11_col4" class="data row11 col4">0.000000</td>
      <td id="T_3dfed_row11_col5" class="data row11 col5">0.000040</td>
      <td id="T_3dfed_row11_col6" class="data row11 col6">0.000000</td>
      <td id="T_3dfed_row11_col7" class="data row11 col7">0.000000</td>
      <td id="T_3dfed_row11_col8" class="data row11 col8">0.000000</td>
      <td id="T_3dfed_row11_col9" class="data row11 col9">0.000000</td>
      <td id="T_3dfed_row11_col10" class="data row11 col10">0.000000</td>
      <td id="T_3dfed_row11_col11" class="data row11 col11">0.000000</td>
      <td id="T_3dfed_row11_col12" class="data row11 col12">0.000013</td>
      <td id="T_3dfed_row11_col13" class="data row11 col13">0.000000</td>
      <td id="T_3dfed_row11_col14" class="data row11 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_3dfed_level0_row12" class="row_heading level0 row12">TO</th>
      <td id="T_3dfed_row12_col0" class="data row12 col0">0.000000</td>
      <td id="T_3dfed_row12_col1" class="data row12 col1">0.000000</td>
      <td id="T_3dfed_row12_col2" class="data row12 col2">0.000000</td>
      <td id="T_3dfed_row12_col3" class="data row12 col3">0.000000</td>
      <td id="T_3dfed_row12_col4" class="data row12 col4">0.000000</td>
      <td id="T_3dfed_row12_col5" class="data row12 col5">0.000000</td>
      <td id="T_3dfed_row12_col6" class="data row12 col6">0.000000</td>
      <td id="T_3dfed_row12_col7" class="data row12 col7">0.000000</td>
      <td id="T_3dfed_row12_col8" class="data row12 col8">0.000000</td>
      <td id="T_3dfed_row12_col9" class="data row12 col9">0.000000</td>
      <td id="T_3dfed_row12_col10" class="data row12 col10">0.000000</td>
      <td id="T_3dfed_row12_col11" class="data row12 col11">0.000000</td>
      <td id="T_3dfed_row12_col12" class="data row12 col12">0.000000</td>
      <td id="T_3dfed_row12_col13" class="data row12 col13">0.000000</td>
      <td id="T_3dfed_row12_col14" class="data row12 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_3dfed_level0_row13" class="row_heading level0 row13">UH</th>
      <td id="T_3dfed_row13_col0" class="data row13 col0">0.000000</td>
      <td id="T_3dfed_row13_col1" class="data row13 col1">0.000000</td>
      <td id="T_3dfed_row13_col2" class="data row13 col2">0.000000</td>
      <td id="T_3dfed_row13_col3" class="data row13 col3">0.000000</td>
      <td id="T_3dfed_row13_col4" class="data row13 col4">0.000000</td>
      <td id="T_3dfed_row13_col5" class="data row13 col5">0.000000</td>
      <td id="T_3dfed_row13_col6" class="data row13 col6">0.000000</td>
      <td id="T_3dfed_row13_col7" class="data row13 col7">0.000000</td>
      <td id="T_3dfed_row13_col8" class="data row13 col8">0.000000</td>
      <td id="T_3dfed_row13_col9" class="data row13 col9">0.000000</td>
      <td id="T_3dfed_row13_col10" class="data row13 col10">0.000000</td>
      <td id="T_3dfed_row13_col11" class="data row13 col11">0.000000</td>
      <td id="T_3dfed_row13_col12" class="data row13 col12">0.000000</td>
      <td id="T_3dfed_row13_col13" class="data row13 col13">0.000000</td>
      <td id="T_3dfed_row13_col14" class="data row13 col14">0.000000</td>
    </tr>
    <tr>
      <th id="T_3dfed_level0_row14" class="row_heading level0 row14">VB</th>
      <td id="T_3dfed_row14_col0" class="data row14 col0">0.000111</td>
      <td id="T_3dfed_row14_col1" class="data row14 col1">0.000000</td>
      <td id="T_3dfed_row14_col2" class="data row14 col2">0.989457</td>
      <td id="T_3dfed_row14_col3" class="data row14 col3">0.000104</td>
      <td id="T_3dfed_row14_col4" class="data row14 col4">0.001270</td>
      <td id="T_3dfed_row14_col5" class="data row14 col5">0.000355</td>
      <td id="T_3dfed_row14_col6" class="data row14 col6">0.000000</td>
      <td id="T_3dfed_row14_col7" class="data row14 col7">0.001488</td>
      <td id="T_3dfed_row14_col8" class="data row14 col8">0.175100</td>
      <td id="T_3dfed_row14_col9" class="data row14 col9">0.011251</td>
      <td id="T_3dfed_row14_col10" class="data row14 col10">0.000000</td>
      <td id="T_3dfed_row14_col11" class="data row14 col11">0.000964</td>
      <td id="T_3dfed_row14_col12" class="data row14 col12">0.001253</td>
      <td id="T_3dfed_row14_col13" class="data row14 col13">0.035634</td>
      <td id="T_3dfed_row14_col14" class="data row14 col14">0.001556</td>
    </tr>
    <tr>
      <th id="T_3dfed_level0_row15" class="row_heading level0 row15">WP</th>
      <td id="T_3dfed_row15_col0" class="data row15 col0">0.000000</td>
      <td id="T_3dfed_row15_col1" class="data row15 col1">0.000000</td>
      <td id="T_3dfed_row15_col2" class="data row15 col2">0.000000</td>
      <td id="T_3dfed_row15_col3" class="data row15 col3">0.000000</td>
      <td id="T_3dfed_row15_col4" class="data row15 col4">0.000000</td>
      <td id="T_3dfed_row15_col5" class="data row15 col5">0.000000</td>
      <td id="T_3dfed_row15_col6" class="data row15 col6">0.000000</td>
      <td id="T_3dfed_row15_col7" class="data row15 col7">0.000000</td>
      <td id="T_3dfed_row15_col8" class="data row15 col8">0.000000</td>
      <td id="T_3dfed_row15_col9" class="data row15 col9">0.000000</td>
      <td id="T_3dfed_row15_col10" class="data row15 col10">0.000000</td>
      <td id="T_3dfed_row15_col11" class="data row15 col11">0.000000</td>
      <td id="T_3dfed_row15_col12" class="data row15 col12">0.000000</td>
      <td id="T_3dfed_row15_col13" class="data row15 col13">0.000000</td>
      <td id="T_3dfed_row15_col14" class="data row15 col14">0.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</section>
</section>
<section id="eta-version" class="level1">
<h1>ETA Version</h1>
<p>This version uses Pandas, but assumes that data are stored in F2 compliant dataframes, i.e.&nbsp;there is TOKENS table.</p>
<p>All of the resulting data are put where they belong in the model.</p>
<section id="define-the-function" class="level2">
<h2 class="anchored" data-anchor-id="define-the-function">Define the function</h2>
<div class="cell" data-scrolled="true" data-tags="[]" data-execution_count="49">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi_eta(sent_tokens, verbose<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co">    - _sent_tokens_ must be a selection from an F1 TOKENS table</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assumes HMM is in scope</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Import model</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    TAGS <span class="op">=</span> HMM.index.to_list()</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    PI <span class="op">=</span> HMM.start.cp</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    AM <span class="op">=</span> HMM.trans</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    BM <span class="op">=</span> HMM.emit</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract basic data</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    ohco <span class="op">=</span> sent_tokens.index.names <span class="co"># Save for return </span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    TOKENS <span class="op">=</span> sent_tokens.reset_index() <span class="co"># Reset index so we can access term_str as a column</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define dataframes    </span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    LATTICE <span class="op">=</span> pd.DataFrame(np.zeros((<span class="bu">len</span>(TAGS), <span class="bu">len</span>(TOKENS)), dtype<span class="op">=</span><span class="st">'float'</span>), index<span class="op">=</span>TAGS, columns<span class="op">=</span>TOKENS.token_num) </span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    LATTICE.index.name <span class="op">=</span> <span class="st">'pos_group'</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle first word (NB: fallback net yet implemented)</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>    first_word <span class="op">=</span> TOKENS.loc[<span class="dv">0</span>].term_str</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>    LATTICE[<span class="dv">0</span>] <span class="op">=</span> PI <span class="op">*</span> BM[first_word]</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Predict the rest of the sentence</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(TOKENS)): <span class="co"># Offset of token</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>        word <span class="op">=</span> TOKENS.loc[t].term_str</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> s <span class="kw">in</span> TAGS: <span class="co"># tag name</span></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> word <span class="kw">not</span> <span class="kw">in</span> BM.columns:</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>                b <span class="op">=</span> <span class="dv">1</span><span class="op">/</span><span class="bu">len</span>(TAGS) <span class="co"># Fallback probability = equiprobable</span></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>                b <span class="op">=</span> BM.loc[s, word]</span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>            LATTICE.loc[s, t] <span class="op">=</span> (LATTICE[t<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> AM[s] <span class="op">*</span> b).<span class="bu">max</span>()</span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute results (no need for backpointer, etc.) and bind to TOKENS</span></span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># LATTICE = LATTICE / LATTICE.sum() # Normalize diminishing probs</span></span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>    TOKENS[<span class="st">'tag'</span>] <span class="op">=</span> LATTICE.idxmax()</span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>    TOKENS[<span class="st">'prob'</span>] <span class="op">=</span> LATTICE.<span class="bu">max</span>()</span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>    TOKENS[<span class="st">'i'</span>] <span class="op">=</span> np.log2(<span class="dv">1</span><span class="op">/</span>TOKENS.prob)</span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> verbose:</span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>        pp <span class="op">=</span> <span class="dv">2</span><span class="op">**</span>TOKENS.i.mean().<span class="bu">round</span>()</span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">" "</span>.join((TOKENS.term_str <span class="op">+</span> <span class="st">'/'</span> <span class="op">+</span> TOKENS.tag).values), <span class="ss">f"(</span><span class="sc">{</span>pp<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add index back and return</span></span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a>    TOKENS <span class="op">=</span> TOKENS.set_index(ohco)</span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> TOKENS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="try-wiith-one-sentence" class="level2">
<h2 class="anchored" data-anchor-id="try-wiith-one-sentence">Try wiith one sentence</h2>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> TEST_SENTENCES.sample().index[<span class="dv">0</span>]</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># x = 41</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>X2 <span class="op">=</span> viterbi_eta(TEST_TOKENS.loc[x])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>but/CC it/NN was/VB a/DT black/JJ mornings/NN work/NN for/IN her/NN (2199023255552.0)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>X2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>token_str</th>
      <th>term_str</th>
      <th>tag</th>
      <th>prob</th>
      <th>i</th>
    </tr>
    <tr>
      <th>token_num</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>but</td>
      <td>but</td>
      <td>CC</td>
      <td>1.912925e-02</td>
      <td>5.708076</td>
    </tr>
    <tr>
      <th>1</th>
      <td>it</td>
      <td>it</td>
      <td>NN</td>
      <td>3.654355e-05</td>
      <td>14.740024</td>
    </tr>
    <tr>
      <th>2</th>
      <td>was</td>
      <td>was</td>
      <td>VB</td>
      <td>5.415216e-07</td>
      <td>20.816478</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a</td>
      <td>a</td>
      <td>DT</td>
      <td>1.764791e-08</td>
      <td>25.755927</td>
    </tr>
    <tr>
      <th>4</th>
      <td>black</td>
      <td>black</td>
      <td>JJ</td>
      <td>9.256373e-12</td>
      <td>36.652690</td>
    </tr>
    <tr>
      <th>5</th>
      <td>morning's</td>
      <td>mornings</td>
      <td>NN</td>
      <td>6.373707e-16</td>
      <td>50.478717</td>
    </tr>
    <tr>
      <th>6</th>
      <td>work</td>
      <td>work</td>
      <td>NN</td>
      <td>1.049796e-19</td>
      <td>63.046524</td>
    </tr>
    <tr>
      <th>7</th>
      <td>for</td>
      <td>for</td>
      <td>IN</td>
      <td>1.616030e-21</td>
      <td>69.068036</td>
    </tr>
    <tr>
      <th>8</th>
      <td>her</td>
      <td>her</td>
      <td>NN</td>
      <td>1.736759e-24</td>
      <td>78.929877</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="try-with-all-sentences" class="level2">
<h2 class="anchored" data-anchor-id="try-with-all-sentences">Try with all sentences</h2>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>TEST <span class="op">=</span> TEST_TOKENS.groupby(<span class="st">'sent_id'</span>, group_keys<span class="op">=</span><span class="va">False</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: viterbi_eta(x, <span class="va">False</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>sample_sentence_id <span class="op">=</span> TEST_SENTENCES.sample().index[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>sample_sentence_id</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>10</code></pre>
</div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>TEST.loc[sample_sentence_id]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>token_str</th>
      <th>term_str</th>
      <th>tag</th>
      <th>prob</th>
      <th>i</th>
    </tr>
    <tr>
      <th>token_num</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>but</td>
      <td>but</td>
      <td>CC</td>
      <td>1.912925e-02</td>
      <td>5.708076</td>
    </tr>
    <tr>
      <th>1</th>
      <td>the</td>
      <td>the</td>
      <td>DT</td>
      <td>1.168278e-03</td>
      <td>9.741401</td>
    </tr>
    <tr>
      <th>2</th>
      <td>intercourse</td>
      <td>intercourse</td>
      <td>NN</td>
      <td>1.323096e-07</td>
      <td>22.849579</td>
    </tr>
    <tr>
      <th>3</th>
      <td>of</td>
      <td>of</td>
      <td>IN</td>
      <td>8.300612e-09</td>
      <td>26.844135</td>
    </tr>
    <tr>
      <th>4</th>
      <td>the</td>
      <td>the</td>
      <td>DT</td>
      <td>1.595997e-09</td>
      <td>29.222895</td>
    </tr>
    <tr>
      <th>5</th>
      <td>last</td>
      <td>last</td>
      <td>JJ</td>
      <td>4.262058e-12</td>
      <td>37.771587</td>
    </tr>
    <tr>
      <th>6</th>
      <td>seven</td>
      <td>seven</td>
      <td>CD</td>
      <td>1.945256e-16</td>
      <td>52.190889</td>
    </tr>
    <tr>
      <th>7</th>
      <td>years</td>
      <td>years</td>
      <td>NN</td>
      <td>1.362521e-19</td>
      <td>62.670355</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="what-pos-tags-are-hardest-to-predict" class="level2">
<h2 class="anchored" data-anchor-id="what-pos-tags-are-hardest-to-predict">What POS tags are hardest to predict?</h2>
<p>First, create a dataframe for predict POS tags.</p>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>TEST_POS <span class="op">=</span> TEST.groupby(<span class="st">'tag'</span>).i.mean().to_frame(<span class="st">'mean_i'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>TEST_POS_IDX <span class="op">=</span> TEST_POS.index</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>TEST_POS <span class="op">=</span> TEST_POS.merge(POS_GROUP, left_on<span class="op">=</span><span class="st">'tag'</span>, right_on<span class="op">=</span><span class="st">'pos_group'</span>).set_index(TEST_POS_IDX)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span>(TEST_POS_IDX)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>TEST_POS[<span class="st">'label'</span>] <span class="op">=</span> TEST_POS.index <span class="op">+</span> <span class="st">' /'</span> <span class="op">+</span> TEST_POS[<span class="st">'def'</span>].<span class="bu">str</span>.split(<span class="vs">r'[,;]'</span>).<span class="bu">str</span>[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>TEST_POS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>mean_i</th>
      <th>n</th>
      <th>def</th>
      <th>p</th>
      <th>i</th>
      <th>h</th>
      <th>label</th>
    </tr>
    <tr>
      <th>tag</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CC</th>
      <td>39.029791</td>
      <td>83450</td>
      <td>conjunction, coordinating</td>
      <td>0.040530</td>
      <td>4.624859</td>
      <td>0.187446</td>
      <td>CC / conjunction</td>
    </tr>
    <tr>
      <th>CD</th>
      <td>64.896161</td>
      <td>12610</td>
      <td>numeral, cardinal</td>
      <td>0.006124</td>
      <td>7.351202</td>
      <td>0.045022</td>
      <td>CD / numeral</td>
    </tr>
    <tr>
      <th>DT</th>
      <td>44.353681</td>
      <td>204813</td>
      <td>determiner</td>
      <td>0.099474</td>
      <td>3.329535</td>
      <td>0.331203</td>
      <td>DT / determiner</td>
    </tr>
    <tr>
      <th>IN</th>
      <td>60.731755</td>
      <td>264122</td>
      <td>preposition or conjunction, subordinating</td>
      <td>0.128279</td>
      <td>2.962638</td>
      <td>0.380046</td>
      <td>IN / preposition or conjunction</td>
    </tr>
    <tr>
      <th>JJ</th>
      <td>63.466369</td>
      <td>165133</td>
      <td>adjective or numeral, ordinal;  adjective, co...</td>
      <td>0.080202</td>
      <td>3.640214</td>
      <td>0.291953</td>
      <td>JJ / adjective or numeral</td>
    </tr>
    <tr>
      <th>MD</th>
      <td>54.594098</td>
      <td>31876</td>
      <td>modal auxiliary</td>
      <td>0.015482</td>
      <td>6.013300</td>
      <td>0.093096</td>
      <td>MD / modal auxiliary</td>
    </tr>
    <tr>
      <th>NN</th>
      <td>63.901830</td>
      <td>540387</td>
      <td>noun, common, singular or mass;  noun, proper...</td>
      <td>0.262457</td>
      <td>1.929850</td>
      <td>0.506502</td>
      <td>NN / noun</td>
    </tr>
    <tr>
      <th>RB</th>
      <td>55.894583</td>
      <td>119059</td>
      <td>adverb;  adverb, comparative;  adverb, superl...</td>
      <td>0.057825</td>
      <td>4.112166</td>
      <td>0.237785</td>
      <td>RB / adverb</td>
    </tr>
    <tr>
      <th>TO</th>
      <td>45.960521</td>
      <td>55581</td>
      <td>"to" as preposition or infinitive marker</td>
      <td>0.026995</td>
      <td>5.211179</td>
      <td>0.140674</td>
      <td>TO / "to" as preposition or infinitive marker</td>
    </tr>
    <tr>
      <th>VB</th>
      <td>52.839969</td>
      <td>356879</td>
      <td>verb, base form;  verb, past tense;  verb, pr...</td>
      <td>0.173330</td>
      <td>2.528407</td>
      <td>0.438249</td>
      <td>VB / verb</td>
    </tr>
    <tr>
      <th>WP</th>
      <td>18.723395</td>
      <td>10772</td>
      <td>WH-pronoun;  WH-pronoun, possessive</td>
      <td>0.005232</td>
      <td>7.578484</td>
      <td>0.039649</td>
      <td>WP / WH-pronoun</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>TEST_POS.reset_index().set_index(<span class="st">'label'</span>).mean_i.sort_values().plot.barh()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="M04_02_HMM_files/figure-html/cell-60-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="add-features-to-sentences" class="level2">
<h2 class="anchored" data-anchor-id="add-features-to-sentences">Add features to sentences</h2>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>TEST[<span class="st">'code'</span>] <span class="op">=</span> TEST.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.term_str <span class="op">+</span> <span class="st">'/'</span> <span class="op">+</span> x.tag, axis<span class="op">=</span><span class="dv">1</span>) </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>TEST_SENTENCES[<span class="st">'code'</span>] <span class="op">=</span> TEST.groupby(<span class="st">'sent_id'</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">' '</span>.join(x.code))</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>TEST_SENTENCES[<span class="st">'i_mean'</span>] <span class="op">=</span> TEST.groupby(<span class="st">'sent_id'</span>).i.mean().<span class="bu">round</span>(<span class="dv">2</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>TEST_SENTENCES[<span class="st">'pp'</span>] <span class="op">=</span> np.exp2(TEST_SENTENCES.i_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>TEST_SENTENCES.sort_values(<span class="st">'pp'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>sent_str</th>
      <th>code</th>
      <th>i_mean</th>
      <th>pp</th>
    </tr>
    <tr>
      <th>sent_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>23</th>
      <td>and a Miss Taylor in the house</td>
      <td>and/CC a/DT miss/NN taylor/NN in/IN the/DT hou...</td>
      <td>27.62</td>
      <td>2.062759e+08</td>
    </tr>
    <tr>
      <th>10</th>
      <td>but the intercourse of the last seven years</td>
      <td>but/CC the/DT intercourse/NN of/IN the/DT last...</td>
      <td>30.87</td>
      <td>1.962438e+09</td>
    </tr>
    <tr>
      <th>15</th>
      <td>interested in all its concerns</td>
      <td>interested/JJ in/IN all/DT its/NN concerns/NN</td>
      <td>32.14</td>
      <td>4.732646e+09</td>
    </tr>
    <tr>
      <th>27</th>
      <td>but he was no companion for her</td>
      <td>but/CC he/NN was/VB no/DT companion/NN for/IN ...</td>
      <td>32.69</td>
      <td>6.929000e+09</td>
    </tr>
    <tr>
      <th>30</th>
      <td>and Mr Woodhouse had not married early</td>
      <td>and/CC mr/NN woodhouse/NN had/VB not/RB marrie...</td>
      <td>33.02</td>
      <td>8.709846e+09</td>
    </tr>
    <tr>
      <th>22</th>
      <td>only half a mile from them</td>
      <td>only/RB half/JJ a/DT mile/NN from/IN them/NN</td>
      <td>34.80</td>
      <td>2.991189e+10</td>
    </tr>
    <tr>
      <th>33</th>
      <td>without activity of mind or body</td>
      <td>without/IN activity/NN of/IN mind/NN or/CC bod...</td>
      <td>34.82</td>
      <td>3.032944e+10</td>
    </tr>
    <tr>
      <th>24</th>
      <td>and with all her advantages natural and domestic</td>
      <td>and/CC with/IN all/DT her/NN advantages/NN nat...</td>
      <td>36.36</td>
      <td>8.819636e+10</td>
    </tr>
    <tr>
      <th>19</th>
      <td>How was she to bear the change</td>
      <td>how/NN was/VB she/NN to/TO bear/VB the/DT chan...</td>
      <td>37.44</td>
      <td>1.864503e+11</td>
    </tr>
    <tr>
      <th>14</th>
      <td>knowing all the ways of the family</td>
      <td>knowing/VB all/DT the/DT ways/NN of/IN the/DT ...</td>
      <td>37.52</td>
      <td>1.970813e+11</td>
    </tr>
    <tr>
      <th>26</th>
      <td>She dearly loved her father</td>
      <td>she/NN dearly/RB loved/VB her/NN father/NN</td>
      <td>39.89</td>
      <td>1.018794e+12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>but it was a black morning's work for her</td>
      <td>but/CC it/NN was/VB a/DT black/JJ mornings/NN ...</td>
      <td>40.58</td>
      <td>1.643604e+12</td>
    </tr>
    <tr>
      <th>29</th>
      <td>The evil of the actual disparity in their ages</td>
      <td>the/DT evil/NN of/IN the/DT actual/JJ disparit...</td>
      <td>41.13</td>
      <td>2.406377e+12</td>
    </tr>
    <tr>
      <th>9</th>
      <td>A large debt of gratitude was owing here</td>
      <td>a/DT large/JJ debt/NN of/IN gratitude/NN was/V...</td>
      <td>42.05</td>
      <td>4.553143e+12</td>
    </tr>
    <tr>
      <th>32</th>
      <td>for having been a valetudinarian all his life</td>
      <td>for/IN having/VB been/VB a/DT valetudinarian/J...</td>
      <td>43.55</td>
      <td>1.287823e+13</td>
    </tr>
    <tr>
      <th>31</th>
      <td>was much increased by his constitution and habits</td>
      <td>was/VB much/JJ increased/VB by/IN his/NN const...</td>
      <td>45.61</td>
      <td>5.370047e+13</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The event had every promise of happiness for h...</td>
      <td>the/DT event/NN had/VB every/DT promise/NN of/...</td>
      <td>45.65</td>
      <td>5.521020e+13</td>
    </tr>
    <tr>
      <th>28</th>
      <td>He could not meet her in conversation rational...</td>
      <td>he/NN could/MD not/RB meet/VB her/NN in/IN con...</td>
      <td>52.38</td>
      <td>5.860723e+15</td>
    </tr>
    <tr>
      <th>13</th>
      <td>She had been a friend and companion such as fe...</td>
      <td>she/NN had/VB been/VB a/DT friend/NN and/CC co...</td>
      <td>52.66</td>
      <td>7.116060e+15</td>
    </tr>
    <tr>
      <th>34</th>
      <td>he was a much older man in ways than in years</td>
      <td>he/NN was/VB a/DT much/JJ older/JJ man/NN in/I...</td>
      <td>53.01</td>
      <td>9.069849e+15</td>
    </tr>
    <tr>
      <th>25</th>
      <td>she was now in great danger of suffering from ...</td>
      <td>she/NN was/VB now/RB in/IN great/JJ danger/NN ...</td>
      <td>54.34</td>
      <td>2.280184e+16</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Her sister though comparatively but little rem...</td>
      <td>her/NN sister/NN though/IN comparatively/RB bu...</td>
      <td>54.35</td>
      <td>2.296044e+16</td>
    </tr>
    <tr>
      <th>18</th>
      <td>and who had such an affection for her as could...</td>
      <td>and/CC who/WP had/VB such/JJ an/DT affection/N...</td>
      <td>54.67</td>
      <td>2.866222e+16</td>
    </tr>
    <tr>
      <th>17</th>
      <td>one to whom she could speak every thought as i...</td>
      <td>one/CD to/TO whom/WP she/NN could/MD speak/VB ...</td>
      <td>55.21</td>
      <td>4.167408e+16</td>
    </tr>
    <tr>
      <th>0</th>
      <td>the quick brown fox jumped over the lazy dogs</td>
      <td>the/DT quick/JJ brown/NN fox/NN jumped/VB over...</td>
      <td>55.94</td>
      <td>6.912226e+16</td>
    </tr>
    <tr>
      <th>8</th>
      <td>and how nursed her through the various illness...</td>
      <td>and/CC how/NN nursed/VB her/NN through/IN the/...</td>
      <td>56.31</td>
      <td>8.933035e+16</td>
    </tr>
    <tr>
      <th>36</th>
      <td>his talents could not have recommended him at ...</td>
      <td>his/NN talents/NN could/MD not/RB have/VB reco...</td>
      <td>56.46</td>
      <td>9.911823e+16</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The want of Miss Taylor would be felt every ho...</td>
      <td>the/DT want/NN of/IN miss/NN taylor/NN would/M...</td>
      <td>58.35</td>
      <td>3.673671e+17</td>
    </tr>
    <tr>
      <th>40</th>
      <td>before Christmas brought the next visit from I...</td>
      <td>before/IN christmas/NN brought/VB the/DT next/...</td>
      <td>59.56</td>
      <td>8.498583e+17</td>
    </tr>
    <tr>
      <th>16</th>
      <td>and peculiarly interested in herself in every ...</td>
      <td>and/CC peculiarly/RB interested/JJ in/IN herse...</td>
      <td>60.13</td>
      <td>1.261635e+18</td>
    </tr>
    <tr>
      <th>21</th>
      <td>but Emma was aware that great must be the diff...</td>
      <td>but/CC emma/NN was/VB aware/JJ that/IN great/J...</td>
      <td>63.66</td>
      <td>1.457369e+19</td>
    </tr>
    <tr>
      <th>11</th>
      <td>the equal footing and perfect unreserve which ...</td>
      <td>the/DT equal/JJ footing/NN and/CC perfect/JJ u...</td>
      <td>66.53</td>
      <td>1.065432e+20</td>
    </tr>
    <tr>
      <th>20</th>
      <td>It was true that her friend was going only hal...</td>
      <td>it/NN was/VB true/JJ that/IN her/NN friend/NN ...</td>
      <td>68.34</td>
      <td>3.735854e+20</td>
    </tr>
    <tr>
      <th>39</th>
      <td>and many a long October and November evening m...</td>
      <td>and/CC many/JJ a/DT long/JJ october/NN and/CC ...</td>
      <td>69.25</td>
      <td>7.019840e+20</td>
    </tr>
    <tr>
      <th>12</th>
      <td>on their being left to each other was yet a de...</td>
      <td>on/IN their/NN being/VB left/VB to/TO each/DT ...</td>
      <td>69.46</td>
      <td>8.119766e+20</td>
    </tr>
    <tr>
      <th>41</th>
      <td>and their little children to fill the house an...</td>
      <td>and/CC their/NN little/JJ children/NN to/TO fi...</td>
      <td>69.56</td>
      <td>8.702549e+20</td>
    </tr>
    <tr>
      <th>35</th>
      <td>and though everywhere beloved for the friendli...</td>
      <td>and/CC though/IN everywhere/NN beloved/VB for/...</td>
      <td>72.67</td>
      <td>7.513630e+21</td>
    </tr>
    <tr>
      <th>5</th>
      <td>She recalled her past kindness the kindness th...</td>
      <td>she/NN recalled/VB her/NN past/NN kindness/NN ...</td>
      <td>73.80</td>
      <td>1.644424e+22</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mr Weston was a man of unexceptionable charact...</td>
      <td>mr/NN weston/NN was/VB a/DT man/NN of/IN unexc...</td>
      <td>77.37</td>
      <td>1.952948e+23</td>
    </tr>
    <tr>
      <th>7</th>
      <td>how she had devoted all her powers to attach a...</td>
      <td>how/NN she/NN had/VB devoted/VB all/DT her/NN ...</td>
      <td>80.76</td>
      <td>2.047305e+24</td>
    </tr>
    <tr>
      <th>38</th>
      <td>being settled in London only sixteen miles off...</td>
      <td>being/VB settled/VB in/IN london/NN only/RB si...</td>
      <td>81.49</td>
      <td>3.395739e+24</td>
    </tr>
    <tr>
      <th>6</th>
      <td>how she had taught and how she had played with...</td>
      <td>how/NN she/NN had/VB taught/VB and/CC how/NN s...</td>
      <td>85.73</td>
      <td>6.416549e+25</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../lessons/M04_NLP/M04_01_Pipeline.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">NLP and the Pipeline</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../lessons/M05_VectorSpaceModels/M05_01_BOW_TFIDF.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-title">Vector Spaces, BOW, and TFIDF</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>